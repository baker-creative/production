{
  "version": 3,
  "sources": ["../../src/deps/storelocator.js"],
  "sourcesContent": ["/*! jQuery Google Maps Store Locator - v3.1.12 - 2023-06-19\r\n * http://www.bjornblog.com/web/jquery-store-locator-plugin\r\n * Copyright (c) 2023 Bjorn Holine; Licensed MIT */\r\n\r\n(function ($, window, document, undefined) {\r\n\t'use strict';\r\n\r\n\tvar pluginName = 'storeLocator';\r\n\r\n\t// Only allow for one instantiation of this script and make sure Google Maps API is included\r\n\tif (typeof $.fn[pluginName] !== 'undefined' || typeof google === 'undefined') {\r\n\t\treturn;\r\n\t}\r\n\r\n\t// Variables used across multiple methods\r\n\tvar $this,\r\n\t\tmap,\r\n\t\tlistTemplate,\r\n\t\tinfowindowTemplate,\r\n\t\tdataTypeRead,\r\n\t\toriginalOrigin,\r\n\t\toriginalData,\r\n\t\toriginalZoom,\r\n\t\tdataRequest,\r\n\t\tsearchInput,\r\n\t\taddressInput,\r\n\t\tolat,\r\n\t\tolng,\r\n\t\tstoreNum,\r\n\t\tdirectionsDisplay,\r\n\t\tdirectionsService,\r\n\t\tprevSelectedMarkerBefore,\r\n\t\tprevSelectedMarkerAfter,\r\n\t\tfirstRun,\r\n\t\treload,\r\n\t\tnameAttrs,\r\n\t\toriginalFilterVals;\r\n\tvar featuredset = [],\r\n\t\tlocationset = [],\r\n\t\tnormalset = [],\r\n\t\tmarkers = [];\r\n\tvar filters = {},\r\n\t\tlocationData = {},\r\n\t\tGeoCodeCalc = {},\r\n\t\tmappingObj = {};\r\n\r\n\t// Create the defaults once. DO NOT change these settings in this file - settings should be overridden in the plugin call\r\n\tvar defaults = {\r\n\t\tajaxData: null,\r\n\t\taltDistanceNoResult: false,\r\n\t\tautoComplete: false,\r\n\t\tautoCompleteDisableListener: false,\r\n\t\tautoCompleteOptions: {},\r\n\t\tautoGeocode: false,\r\n\t\tbounceMarker: true, // Deprecated.\r\n\t\tcatMarkers: null,\r\n\t\tdataLocation: 'data/locations.json',\r\n\t\tdataRaw: null,\r\n\t\tdataType: 'json',\r\n\t\tdebug: false,\r\n\t\tdefaultLat: null,\r\n\t\tdefaultLng: null,\r\n\t\tdefaultLoc: false,\r\n\t\tdisableAlphaMarkers: false,\r\n\t\tdistanceAlert: 60,\r\n\t\tdragSearch: false,\r\n\t\texclusiveFiltering: false,\r\n\t\texclusiveTax: null,\r\n\t\tfeaturedDistance: null,\r\n\t\tfeaturedLocations: false,\r\n\t\tfullMapStart: false,\r\n\t\tfullMapStartBlank: false,\r\n\t\tfullMapStartListLimit: false,\r\n\t\tinfoBubble: null,\r\n\t\tinlineDirections: false,\r\n\t\tlengthUnit: 'm',\r\n\t\tlistColor1: '#ffffff',\r\n\t\tlistColor2: '#eeeeee',\r\n\t\tloading: false,\r\n\t\tlocationsPerPage: 10,\r\n\t\tmapSettings: {\r\n\t\t\tmapTypeId: google.maps.MapTypeId.ROADMAP,\r\n\t\t\tzoom: 12\r\n\t\t},\r\n\t\tmarkerCluster: null,\r\n\t\tmarkerImg: null,\r\n\t\tmarkerDim: null,\r\n\t\tmaxDistance: false,\r\n\t\tmodal: false,\r\n\t\tnameAttribute: 'name',\r\n\t\tnameSearch: false,\r\n\t\tnoForm: false,\r\n\t\topenNearest: false,\r\n\t\toriginMarker: false,\r\n\t\toriginMarkerDim: null,\r\n\t\toriginMarkerImg: null,\r\n\t\tpagination: false,\r\n\t\tquerystringParams: false,\r\n\t\tselectedMarkerImg: null,\r\n\t\tselectedMarkerImgDim: null,\r\n\t\tsessionStorage: false,\r\n\t\tslideMap: true,\r\n\t\tsortBy: null,\r\n\t\tstoreLimit: 26,\r\n\t\ttaxonomyFilters: null,\r\n\t\tvisibleMarkersList: false,\r\n\t\txmlElement: 'marker',\r\n\t\t// HTML elements\r\n\t\taddressID: 'bh-sl-address',\r\n\t\tcloseIcon: 'bh-sl-close-icon',\r\n\t\tformContainer: 'bh-sl-form-container',\r\n\t\tformID: 'bh-sl-user-location',\r\n\t\tgeocodeID: null,\r\n\t\tlengthSwapID: 'bh-sl-length-swap',\r\n\t\tloadingContainer: 'bh-sl-loading',\r\n\t\tlocationList: 'bh-sl-loc-list',\r\n\t\tmapID: 'bh-sl-map',\r\n\t\tmaxDistanceID: 'bh-sl-maxdistance',\r\n\t\tmodalContent: 'bh-sl-modal-content',\r\n\t\tmodalWindow: 'bh-sl-modal-window',\r\n\t\torderID: 'bh-sl-order',\r\n\t\toverlay: 'bh-sl-overlay',\r\n\t\tregionID: 'bh-sl-region',\r\n\t\tsearchID: 'bh-sl-search',\r\n\t\tsortID: 'bh-sl-sort',\r\n\t\ttaxonomyFiltersContainer: 'bh-sl-filters-container',\r\n\t\t// Templates\r\n\t\tinfowindowTemplatePath: 'assets/js/plugins/storeLocator/templates/infowindow-description.html',\r\n\t\tlistTemplatePath: 'assets/js/plugins/storeLocator/templates/location-list-description.html',\r\n\t\tKMLinfowindowTemplatePath: 'assets/js/plugins/storeLocator/templates/kml-infowindow-description.html',\r\n\t\tKMLlistTemplatePath: 'assets/js/plugins/storeLocator/templates/kml-location-list-description.html',\r\n\t\tlistTemplateID: null,\r\n\t\tinfowindowTemplateID: null,\r\n\t\t// Callbacks\r\n\t\tcallbackAutoGeoSuccess: null,\r\n\t\tcallbackBeforeSend: null,\r\n\t\tcallbackCloseDirections: null,\r\n\t\tcallbackCreateMarker: null,\r\n\t\tcallbackDirectionsRequest: null,\r\n\t\tcallbackFilters: null,\r\n\t\tcallbackFormVals: null,\r\n\t\tcallbackGeocodeRestrictions: null,\r\n\t\tcallbackJsonp: null,\r\n\t\tcallbackListClick: null,\r\n\t\tcallbackMapSet: null,\r\n\t\tcallbackMarkerClick: null,\r\n\t\tcallbackModalClose: null,\r\n\t\tcallbackModalOpen: null,\r\n\t\tcallbackModalReady: null,\r\n\t\tcallbackNearestLoc: null,\r\n\t\tcallbackNoResults: null,\r\n\t\tcallbackNotify: null,\r\n\t\tcallbackOrder: null,\r\n\t\tcallbackPageChange: null,\r\n\t\tcallbackRegion: null,\r\n\t\tcallbackSorting: null,\r\n\t\tcallbackSuccess: null,\r\n\t\t// Language options\r\n\t\taddressErrorAlert: 'Unable to find address',\r\n\t\tautoGeocodeErrorAlert: 'Automatic location detection failed. Please fill in your address or zip code.',\r\n\t\tdistanceErrorAlert: 'Unfortunately, our closest location is more than ',\r\n\t\tkilometerLang: 'kilometer',\r\n\t\tkilometersLang: 'kilometers',\r\n\t\tmileLang: 'mile',\r\n\t\tmilesLang: 'miles',\r\n\t\tnoResultsTitle: 'No results',\r\n\t\tnoResultsDesc: 'No locations were found with the given criteria. Please modify your selections or input.',\r\n\t\tnextPage: 'Next &raquo;',\r\n\t\tprevPage: '&laquo; Prev'\r\n\t};\r\n\r\n\t// Plugin constructor\r\n\tfunction Plugin(element, options) {\r\n\t\t$this = $(element);\r\n\t\tthis.element = element;\r\n\t\tthis.settings = $.extend({}, defaults, options);\r\n\t\tthis._defaults = defaults;\r\n\t\tthis._name = pluginName;\r\n\t\tthis.init();\r\n\t}\r\n\r\n\t// Avoid Plugin.prototype conflicts\r\n\t$.extend(Plugin.prototype, {\r\n\t\t/**\r\n\t\t * Init function\r\n\t\t */\r\n\t\tinit: function () {\r\n\t\t\tvar _this = this;\r\n\t\t\tthis.writeDebug('init');\r\n\t\t\t// Calculate geocode distance functions\r\n\t\t\tif (this.settings.lengthUnit === 'km') {\r\n\t\t\t\t// Kilometers\r\n\t\t\t\tGeoCodeCalc.EarthRadius = 6367.0;\r\n\t\t\t} else {\r\n\t\t\t\t// Default is miles\r\n\t\t\t\tGeoCodeCalc.EarthRadius = 3956.0;\r\n\t\t\t}\r\n\r\n\t\t\t// KML is read as XML\r\n\t\t\tif (this.settings.dataType === 'kml') {\r\n\t\t\t\tdataTypeRead = 'xml';\r\n\t\t\t} else {\r\n\t\t\t\tdataTypeRead = this.settings.dataType;\r\n\t\t\t}\r\n\r\n\t\t\t// Add directions panel if enabled\r\n\t\t\tif (this.settings.inlineDirections === true) {\r\n\t\t\t\t$('.' + this.settings.locationList).prepend('<div class=\"bh-sl-directions-panel\"></div>');\r\n\t\t\t}\r\n\r\n\t\t\t// Save the original zoom setting so it can be retrieved if taxonomy filtering resets it\r\n\t\t\toriginalZoom = this.settings.mapSettings.zoom;\r\n\r\n\t\t\t// Add Handlebars helper for handling URL output\r\n\t\t\tHandlebars.registerHelper('niceURL', function (url) {\r\n\t\t\t\tif (url) {\r\n\t\t\t\t\treturn url.replace('https://', '').replace('http://', '');\r\n\t\t\t\t}\r\n\t\t\t});\r\n\r\n\t\t\t// Do taxonomy filtering if set\r\n\t\t\tif (this.settings.taxonomyFilters !== null) {\r\n\t\t\t\tthis.taxonomyFiltering();\r\n\t\t\t}\r\n\r\n\t\t\t// Do sorting and ordering if set.\r\n\t\t\tthis.sorting();\r\n\t\t\tthis.order();\r\n\r\n\t\t\t// Add modal window divs if set\r\n\t\t\tif (this.settings.modal === true) {\r\n\t\t\t\t// Clone the filters if there are any so they can be used in the modal\r\n\t\t\t\tif (this.settings.taxonomyFilters !== null) {\r\n\t\t\t\t\t// Clone the filters\r\n\t\t\t\t\t$('.' + this.settings.taxonomyFiltersContainer)\r\n\t\t\t\t\t\t.clone(true, true)\r\n\t\t\t\t\t\t.prependTo($this);\r\n\t\t\t\t}\r\n\r\n\t\t\t\t$this.wrap(\r\n\t\t\t\t\t'<div class=\"' + this.settings.overlay + '\"><div class=\"' + this.settings.modalWindow + '\"><div class=\"' + this.settings.modalContent + '\">'\r\n\t\t\t\t);\r\n\t\t\t\t$('.' + this.settings.modalWindow).prepend('<div class=\"' + this.settings.closeIcon + '\"></div>');\r\n\t\t\t\t$('.' + this.settings.overlay).hide();\r\n\t\t\t}\r\n\r\n\t\t\t// Set up Google Places autocomplete if it's set to true\r\n\t\t\tif (this.settings.autoComplete === true) {\r\n\t\t\t\tvar searchInput = document.getElementById(this.settings.addressID);\r\n\t\t\t\tvar autoPlaces = new google.maps.places.Autocomplete(searchInput, this.settings.autoCompleteOptions);\r\n\r\n\t\t\t\t// Add listener when autoComplete selection changes.\r\n\t\t\t\tif (this.settings.autoComplete === true && this.settings.autoCompleteDisableListener !== true) {\r\n\t\t\t\t\tautoPlaces.addListener('place_changed', function (e) {\r\n\t\t\t\t\t\t_this.processForm(e);\r\n\t\t\t\t\t});\r\n\t\t\t\t}\r\n\t\t\t}\r\n\r\n\t\t\t// Load the templates and continue from there\r\n\t\t\tthis._loadTemplates();\r\n\t\t},\r\n\r\n\t\t/**\r\n\t\t * Destroy\r\n\t\t * Note: The Google map is not destroyed here because Google recommends using a single instance and reusing it\r\n\t\t * (it's not really supported)\r\n\t\t */\r\n\t\tdestroy: function () {\r\n\t\t\tthis.writeDebug('destroy');\r\n\t\t\t// Reset\r\n\t\t\tthis.reset();\r\n\t\t\tvar $mapDiv = $('#' + this.settings.mapID);\r\n\r\n\t\t\t// Remove marker event listeners\r\n\t\t\tif (markers.length) {\r\n\t\t\t\tfor (var i = 0; i <= markers.length; i++) {\r\n\t\t\t\t\tgoogle.maps.event.removeListener(markers[i]);\r\n\t\t\t\t}\r\n\t\t\t}\r\n\r\n\t\t\t// Remove markup\r\n\t\t\t$('.' + this.settings.locationList + ' ul').empty();\r\n\t\t\tif ($mapDiv.hasClass('bh-sl-map-open')) {\r\n\t\t\t\t$mapDiv.empty().removeClass('bh-sl-map-open');\r\n\t\t\t}\r\n\r\n\t\t\t// Remove modal markup\r\n\t\t\tif (this.settings.modal === true) {\r\n\t\t\t\t$('. ' + this.settings.overlay).remove();\r\n\t\t\t}\r\n\r\n\t\t\t// Remove map style from container\r\n\t\t\t$mapDiv.attr('style', '');\r\n\r\n\t\t\t// Hide map container\r\n\t\t\t$this.hide();\r\n\t\t\t// Remove data\r\n\t\t\t$.removeData($this.get(0));\r\n\t\t\t// Remove namespaced events\r\n\t\t\t$(document).off(pluginName);\r\n\t\t\t// Unbind plugin\r\n\t\t\t$this.unbind();\r\n\t\t},\r\n\r\n\t\t/**\r\n\t\t * Reset function\r\n\t\t * This method clears out all the variables and removes events. It does not reload the map.\r\n\t\t */\r\n\t\treset: function () {\r\n\t\t\tthis.writeDebug('reset');\r\n\t\t\tlocationset = [];\r\n\t\t\tfeaturedset = [];\r\n\t\t\tnormalset = [];\r\n\t\t\tmarkers = [];\r\n\t\t\tfirstRun = false;\r\n\t\t\t$(document).off('click.' + pluginName, '.' + this.settings.locationList + ' li');\r\n\r\n\t\t\tif ($('.' + this.settings.locationList + ' .bh-sl-close-directions-container').length) {\r\n\t\t\t\t$('.bh-sl-close-directions-container').remove();\r\n\t\t\t}\r\n\r\n\t\t\tif (this.settings.inlineDirections === true) {\r\n\t\t\t\t// Remove directions panel if it's there\r\n\t\t\t\tvar $adp = $('.' + this.settings.locationList + ' .adp');\r\n\t\t\t\tif ($adp.length > 0) {\r\n\t\t\t\t\t$adp.remove();\r\n\t\t\t\t\t$('.' + this.settings.locationList + ' ul').fadeIn();\r\n\t\t\t\t}\r\n\t\t\t\t$(document).off('click', '.' + this.settings.locationList + ' li .loc-directions a');\r\n\t\t\t}\r\n\r\n\t\t\tif (this.settings.pagination === true) {\r\n\t\t\t\t$(document).off('click.' + pluginName, '.bh-sl-pagination li');\r\n\t\t\t}\r\n\t\t},\r\n\r\n\t\t/**\r\n\t\t * Reset the form filters\r\n\t\t */\r\n\t\tformFiltersReset: function () {\r\n\t\t\tthis.writeDebug('formFiltersReset');\r\n\t\t\tif (this.settings.taxonomyFilters === null) {\r\n\t\t\t\treturn;\r\n\t\t\t}\r\n\r\n\t\t\tvar $inputs = $('.' + this.settings.taxonomyFiltersContainer + ' input'),\r\n\t\t\t\t$selects = $('.' + this.settings.taxonomyFiltersContainer + ' select');\r\n\r\n\t\t\tif (typeof $inputs !== 'object') {\r\n\t\t\t\treturn;\r\n\t\t\t}\r\n\r\n\t\t\t// Loop over the input fields\r\n\t\t\t$inputs.each(function () {\r\n\t\t\t\tif ($(this).is('input[type=\"checkbox\"]') || $(this).is('input[type=\"radio\"]')) {\r\n\t\t\t\t\t$(this).prop('checked', false);\r\n\t\t\t\t}\r\n\t\t\t});\r\n\r\n\t\t\t// Loop over select fields\r\n\t\t\t$selects.each(function () {\r\n\t\t\t\t$(this).prop('selectedIndex', 0);\r\n\t\t\t});\r\n\t\t},\r\n\r\n\t\t/**\r\n\t\t * Reload everything\r\n\t\t * This method does a reset of everything and reloads the map as it would first appear.\r\n\t\t */\r\n\t\tmapReload: function () {\r\n\t\t\tthis.writeDebug('mapReload');\r\n\t\t\tthis.reset();\r\n\t\t\treload = true;\r\n\r\n\t\t\tif (this.settings.taxonomyFilters !== null) {\r\n\t\t\t\tthis.formFiltersReset();\r\n\t\t\t\tthis.resetDisabledFilterVals();\r\n\t\t\t\tthis.taxonomyFiltersInit();\r\n\t\t\t}\r\n\r\n\t\t\tif (olat && olng) {\r\n\t\t\t\tthis.settings.mapSettings.zoom = originalZoom;\r\n\t\t\t\tthis.processForm();\r\n\t\t\t} else {\r\n\t\t\t\tthis.mapping(mappingObj);\r\n\t\t\t}\r\n\t\t},\r\n\r\n\t\t/**\r\n\t\t * Notifications\r\n\t\t * Some errors use alert by default. This is overridable with the callbackNotify option\r\n\t\t *\r\n\t\t * @param notifyText {string} the notification message\r\n\t\t */\r\n\t\tnotify: function (notifyText) {\r\n\t\t\tthis.writeDebug('notify', notifyText);\r\n\t\t\tif (this.settings.callbackNotify) {\r\n\t\t\t\tthis.settings.callbackNotify.call(this, notifyText);\r\n\t\t\t} else {\r\n\t\t\t\talert(notifyText);\r\n\t\t\t}\r\n\t\t},\r\n\r\n\t\t/**\r\n\t\t * Distance calculations\r\n\t\t */\r\n\t\tgeoCodeCalcToRadian: function (v) {\r\n\t\t\tthis.writeDebug('geoCodeCalcToRadian', v);\r\n\t\t\treturn v * (Math.PI / 180);\r\n\t\t},\r\n\t\tgeoCodeCalcDiffRadian: function (v1, v2) {\r\n\t\t\tthis.writeDebug('geoCodeCalcDiffRadian', arguments);\r\n\t\t\treturn this.geoCodeCalcToRadian(v2) - this.geoCodeCalcToRadian(v1);\r\n\t\t},\r\n\t\tgeoCodeCalcCalcDistance: function (lat1, lng1, lat2, lng2, radius) {\r\n\t\t\tthis.writeDebug('geoCodeCalcCalcDistance', arguments);\r\n\t\t\treturn (\r\n\t\t\t\tradius *\r\n\t\t\t\t2 *\r\n\t\t\t\tMath.asin(\r\n\t\t\t\t\tMath.min(\r\n\t\t\t\t\t\t1,\r\n\t\t\t\t\t\tMath.sqrt(\r\n\t\t\t\t\t\t\tMath.pow(Math.sin(this.geoCodeCalcDiffRadian(lat1, lat2) / 2.0), 2.0) +\r\n\t\t\t\t\t\t\t\tMath.cos(this.geoCodeCalcToRadian(lat1)) *\r\n\t\t\t\t\t\t\t\t\tMath.cos(this.geoCodeCalcToRadian(lat2)) *\r\n\t\t\t\t\t\t\t\t\tMath.pow(Math.sin(this.geoCodeCalcDiffRadian(lng1, lng2) / 2.0), 2.0)\r\n\t\t\t\t\t\t)\r\n\t\t\t\t\t)\r\n\t\t\t\t)\r\n\t\t\t);\r\n\t\t},\r\n\r\n\t\t/**\r\n\t\t * Range helper function for coordinate validation\r\n\t\t *\r\n\t\t * @param min {number} minimum number allowed\r\n\t\t * @param num {number} number to check\r\n\t\t * @param max {number} maximum number allowed\r\n\t\t *\r\n\t\t * @returns {boolean}\r\n\t\t */\r\n\t\tinRange: function (min, num, max) {\r\n\t\t\tthis.writeDebug('inRange', arguments);\r\n\t\t\tnum = Math.abs(num);\r\n\t\t\treturn isFinite(num) && num >= min && num <= max;\r\n\t\t},\r\n\r\n\t\t/**\r\n\t\t * Coordinate validation\r\n\t\t *\r\n\t\t * @param lat {number} latitude\r\n\t\t * @param lng {number} longitude\r\n\t\t *\r\n\t\t * @returns {boolean}\r\n\t\t */\r\n\t\tcoordinatesInRange: function (lat, lng) {\r\n\t\t\tthis.writeDebug('coordinatesInRange', arguments);\r\n\t\t\treturn this.inRange(-90, lat, 90) && this.inRange(-180, lng, 180);\r\n\t\t},\r\n\r\n\t\t/**\r\n\t\t * Check for query string\r\n\t\t *\r\n\t\t * @param param {string} query string parameter to test\r\n\t\t *\r\n\t\t * @returns {string} query string value\r\n\t\t */\r\n\t\tgetQueryString: function (param) {\r\n\t\t\tthis.writeDebug('getQueryString', param);\r\n\t\t\tif (param) {\r\n\t\t\t\tparam = param.replace(/[\\[]/, '\\\\[').replace(/[\\]]/, '\\\\]');\r\n\t\t\t\tvar regex = new RegExp('[\\\\?&]' + param + '=([^&#]*)'),\r\n\t\t\t\t\tresults = regex.exec(location.search);\r\n\t\t\t\treturn results === null ? '' : decodeURIComponent(results[1].replace(/\\+/g, ' '));\r\n\t\t\t}\r\n\t\t},\r\n\r\n\t\t/**\r\n\t\t * Get google.maps.Map instance\r\n\t\t *\r\n\t\t * @returns {Object} google.maps.Map instance\r\n\t\t */\r\n\t\tgetMap: function () {\r\n\t\t\treturn this.map;\r\n\t\t},\r\n\r\n\t\t/**\r\n\t\t * Load templates via Handlebars templates in /templates or inline via IDs - private\r\n\t\t */\r\n\t\t_loadTemplates: function () {\r\n\t\t\tthis.writeDebug('_loadTemplates');\r\n\t\t\tvar source;\r\n\t\t\tvar _this = this;\r\n\t\t\tvar templateError =\r\n\t\t\t\t'<div class=\"bh-sl-error\">Error: Could not load plugin templates. Check the paths and ensure they have been uploaded. Paths will be wrong if you do not run this from a web server.</div>';\r\n\t\t\t// Get the KML templates\r\n\t\t\tif (this.settings.dataType === 'kml' && this.settings.listTemplateID === null && this.settings.infowindowTemplateID === null) {\r\n\t\t\t\t// Try loading the external template files\r\n\t\t\t\t$.when(\r\n\t\t\t\t\t// KML infowindows\r\n\t\t\t\t\t$.get(this.settings.KMLinfowindowTemplatePath, function (template) {\r\n\t\t\t\t\t\tsource = template;\r\n\t\t\t\t\t\tinfowindowTemplate = Handlebars.compile(source);\r\n\t\t\t\t\t}),\r\n\r\n\t\t\t\t\t// KML locations list\r\n\t\t\t\t\t$.get(this.settings.KMLlistTemplatePath, function (template) {\r\n\t\t\t\t\t\tsource = template;\r\n\t\t\t\t\t\tlistTemplate = Handlebars.compile(source);\r\n\t\t\t\t\t})\r\n\t\t\t\t).then(\r\n\t\t\t\t\tfunction () {\r\n\t\t\t\t\t\t// Continue to the main script if templates are loaded successfully\r\n\t\t\t\t\t\t_this.locator();\r\n\t\t\t\t\t},\r\n\t\t\t\t\tfunction () {\r\n\t\t\t\t\t\t// KML templates not loaded\r\n\t\t\t\t\t\t$('.' + _this.settings.formContainer).append(templateError);\r\n\t\t\t\t\t\tthrow new Error('Could not load storeLocator plugin templates');\r\n\t\t\t\t\t}\r\n\t\t\t\t);\r\n\t\t\t}\r\n\t\t\t// Handle script tag template method\r\n\t\t\telse if (this.settings.listTemplateID !== null && this.settings.infowindowTemplateID !== null) {\r\n\t\t\t\t// Infowindows\r\n\t\t\t\tinfowindowTemplate = Handlebars.compile($('#' + this.settings.infowindowTemplateID).html());\r\n\r\n\t\t\t\t// Locations list\r\n\t\t\t\tlistTemplate = Handlebars.compile($('#' + this.settings.listTemplateID).html());\r\n\r\n\t\t\t\t// Continue to the main script\r\n\t\t\t\t_this.locator();\r\n\t\t\t}\r\n\t\t\t// Get the JSON/XML templates\r\n\t\t\telse {\r\n\t\t\t\t// Try loading the external template files\r\n\t\t\t\t$.when(\r\n\t\t\t\t\t// Infowindows\r\n\t\t\t\t\t$.get(this.settings.infowindowTemplatePath, function (template) {\r\n\t\t\t\t\t\tsource = template;\r\n\t\t\t\t\t\tinfowindowTemplate = Handlebars.compile(source);\r\n\t\t\t\t\t}),\r\n\r\n\t\t\t\t\t// Locations list\r\n\t\t\t\t\t$.get(this.settings.listTemplatePath, function (template) {\r\n\t\t\t\t\t\tsource = template;\r\n\t\t\t\t\t\tlistTemplate = Handlebars.compile(source);\r\n\t\t\t\t\t})\r\n\t\t\t\t).then(\r\n\t\t\t\t\tfunction () {\r\n\t\t\t\t\t\t// Continue to the main script if templates are loaded successfully\r\n\t\t\t\t\t\t_this.locator();\r\n\t\t\t\t\t},\r\n\t\t\t\t\tfunction () {\r\n\t\t\t\t\t\t// JSON/XML templates not loaded\r\n\t\t\t\t\t\t$('.' + _this.settings.formContainer).append(templateError);\r\n\t\t\t\t\t\tthrow new Error('Could not load storeLocator plugin templates');\r\n\t\t\t\t\t}\r\n\t\t\t\t);\r\n\t\t\t}\r\n\t\t},\r\n\r\n\t\t/**\r\n\t\t * Primary locator function runs after the templates are loaded\r\n\t\t */\r\n\t\tlocator: function () {\r\n\t\t\tthis.writeDebug('locator');\r\n\t\t\tif (this.settings.slideMap === true) {\r\n\t\t\t\t// Let's hide the map container to begin\r\n\t\t\t\t$this.hide();\r\n\t\t\t}\r\n\r\n\t\t\tthis._start();\r\n\t\t\tthis._formEventHandler();\r\n\t\t},\r\n\r\n\t\t/**\r\n\t\t * Form event handler setup - private\r\n\t\t */\r\n\t\t_formEventHandler: function () {\r\n\t\t\tthis.writeDebug('_formEventHandler');\r\n\t\t\tvar _this = this;\r\n\t\t\t// ASP.net or regular submission?\r\n\t\t\tif (this.settings.noForm === true) {\r\n\t\t\t\t$(document).on('click.' + pluginName, '.' + this.settings.formContainer + ' button', function (e) {\r\n\t\t\t\t\t_this.processForm(e);\r\n\t\t\t\t});\r\n\t\t\t\t$(document).on('keydown.' + pluginName, function (e) {\r\n\t\t\t\t\tif (e.keyCode === 13 && $('#' + _this.settings.addressID).is(':focus')) {\r\n\t\t\t\t\t\t_this.processForm(e);\r\n\t\t\t\t\t}\r\n\t\t\t\t});\r\n\t\t\t} else {\r\n\t\t\t\t$(document).on('submit.' + pluginName, '#' + this.settings.formID, function (e) {\r\n\t\t\t\t\t_this.processForm(e);\r\n\t\t\t\t});\r\n\t\t\t}\r\n\r\n\t\t\t// Reset button trigger.\r\n\t\t\tif ($('.bh-sl-reset').length && $('#' + this.settings.mapID).length) {\r\n\t\t\t\t$(document).on('click.' + pluginName, '.bh-sl-reset', function () {\r\n\t\t\t\t\t_this.mapReload();\r\n\t\t\t\t});\r\n\t\t\t}\r\n\r\n\t\t\t// Track changes to the address search field.\r\n\t\t\t$('#' + this.settings.addressID).on('change.' + pluginName, function () {\r\n\t\t\t\toriginalFilterVals = undefined;\r\n\r\n\t\t\t\t// Unset origin tracking if input field is removed.\r\n\t\t\t\tif ($.trim($('#' + _this.settings.addressID).val()) === '' && (typeof searchInput === 'undefined' || searchInput === '')) {\r\n\t\t\t\t\t// Reset the origin, mapping object, and disabled filter values.\r\n\t\t\t\t\tif (_this.settings.taxonomyFilters !== null && _this.settings.exclusiveFiltering === false) {\r\n\t\t\t\t\t\tolat = undefined;\r\n\t\t\t\t\t\tolng = undefined;\r\n\t\t\t\t\t\toriginalOrigin = undefined;\r\n\t\t\t\t\t\tmappingObj = {};\r\n\t\t\t\t\t\t_this.resetDisabledFilterVals();\r\n\t\t\t\t\t\t_this.taxonomyFiltersInit();\r\n\t\t\t\t\t\t_this.mapping(null);\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\t\t\t});\r\n\t\t},\r\n\r\n\t\t/**\r\n\t\t * AJAX data request - private\r\n\t\t *\r\n\t\t * @param lat {number} latitude\r\n\t\t * @param lng {number} longitude\r\n\t\t * @param address {string} street address\r\n\t\t * @param geocodeData {object} full Google geocode results object\r\n\t\t * @param map (object} Google Maps object.\r\n\t\t *\r\n\t\t * @returns {Object} deferred object\r\n\t\t */\r\n\t\t_getData: function (lat, lng, address, geocodeData, map) {\r\n\t\t\tthis.writeDebug('_getData', arguments);\r\n\t\t\tvar _this = this,\r\n\t\t\t\tnorthEast = '',\r\n\t\t\t\tsouthWest = '',\r\n\t\t\t\tformattedAddress = '';\r\n\r\n\t\t\t// Define extra geocode result info\r\n\t\t\tif (typeof geocodeData !== 'undefined' && typeof geocodeData.geometry.bounds !== 'undefined') {\r\n\t\t\t\tformattedAddress = geocodeData.formatted_address;\r\n\t\t\t\tnorthEast = JSON.stringify(geocodeData.geometry.bounds.getNorthEast());\r\n\t\t\t\tsouthWest = JSON.stringify(geocodeData.geometry.bounds.getSouthWest());\r\n\t\t\t}\r\n\r\n\t\t\t// Before send callback\r\n\t\t\tif (this.settings.callbackBeforeSend) {\r\n\t\t\t\tthis.settings.callbackBeforeSend.call(this, lat, lng, address, formattedAddress, northEast, southWest, map);\r\n\t\t\t}\r\n\r\n\t\t\t// Raw data\r\n\t\t\tif (_this.settings.dataRaw !== null) {\r\n\t\t\t\t// XML\r\n\t\t\t\tif (dataTypeRead === 'xml') {\r\n\t\t\t\t\treturn $.parseXML(_this.settings.dataRaw);\r\n\t\t\t\t}\r\n\r\n\t\t\t\t// JSON\r\n\t\t\t\telse if (dataTypeRead === 'json') {\r\n\t\t\t\t\tif (Array.isArray && Array.isArray(_this.settings.dataRaw)) {\r\n\t\t\t\t\t\treturn _this.settings.dataRaw;\r\n\t\t\t\t\t} else if (typeof _this.settings.dataRaw === 'string') {\r\n\t\t\t\t\t\treturn JSON.parse(_this.settings.dataRaw);\r\n\t\t\t\t\t} else {\r\n\t\t\t\t\t\treturn [];\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t\t// Remote data\r\n\t\t\telse {\r\n\t\t\t\tvar d = $.Deferred();\r\n\r\n\t\t\t\t// Loading\r\n\t\t\t\tif (this.settings.loading === true) {\r\n\t\t\t\t\t$('.' + this.settings.formContainer).append('<div class=\"' + this.settings.loadingContainer + '\"></div>');\r\n\t\t\t\t}\r\n\r\n\t\t\t\t// Data to pass with the AJAX request\r\n\t\t\t\tvar ajaxData = {\r\n\t\t\t\t\torigLat: lat,\r\n\t\t\t\t\torigLng: lng,\r\n\t\t\t\t\torigAddress: address,\r\n\t\t\t\t\tformattedAddress: formattedAddress,\r\n\t\t\t\t\tboundsNorthEast: northEast,\r\n\t\t\t\t\tboundsSouthWest: southWest\r\n\t\t\t\t};\r\n\r\n\t\t\t\t// Set up extra object for custom extra data to be passed with the AJAX request\r\n\t\t\t\tif (this.settings.ajaxData !== null && typeof this.settings.ajaxData === 'object') {\r\n\t\t\t\t\t$.extend(ajaxData, this.settings.ajaxData);\r\n\t\t\t\t}\r\n\r\n\t\t\t\t// AJAX request\r\n\t\t\t\t$.ajax({\r\n\t\t\t\t\ttype: 'GET',\r\n\t\t\t\t\turl:\r\n\t\t\t\t\t\tthis.settings.dataLocation +\r\n\t\t\t\t\t\t(this.settings.dataType === 'jsonp' ? (this.settings.dataLocation.match(/\\?/) ? '&' : '?') + 'callback=?' : ''),\r\n\t\t\t\t\t// Passing the lat, lng, address, formatted address and bounds with the AJAX request so they can optionally be used by back-end languages\r\n\t\t\t\t\tdata: ajaxData,\r\n\t\t\t\t\tdataType: dataTypeRead,\r\n\t\t\t\t\tjsonpCallback: this.settings.dataType === 'jsonp' ? this.settings.callbackJsonp : null\r\n\t\t\t\t})\r\n\t\t\t\t\t.done(function (p) {\r\n\t\t\t\t\t\td.resolve(p);\r\n\r\n\t\t\t\t\t\t// Loading remove\r\n\t\t\t\t\t\tif (_this.settings.loading === true) {\r\n\t\t\t\t\t\t\t$('.' + _this.settings.formContainer + ' .' + _this.settings.loadingContainer).remove();\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t})\r\n\t\t\t\t\t.fail(d.reject);\r\n\t\t\t\treturn d.promise();\r\n\t\t\t}\r\n\t\t},\r\n\r\n\t\t/**\r\n\t\t * Checks for default location, full map, and HTML5 geolocation settings - private\r\n\t\t */\r\n\t\t_start: function () {\r\n\t\t\tthis.writeDebug('_start');\r\n\t\t\tvar _this = this,\r\n\t\t\t\tdoAutoGeo = this.settings.autoGeocode,\r\n\t\t\t\tlatlng;\r\n\r\n\t\t\t// Full map blank start\r\n\t\t\tif (_this.settings.fullMapStartBlank !== false) {\r\n\t\t\t\tvar $mapDiv = $('#' + _this.settings.mapID);\r\n\t\t\t\t$mapDiv.addClass('bh-sl-map-open');\r\n\t\t\t\tvar myOptions = _this.settings.mapSettings;\r\n\t\t\t\tmyOptions.zoom = _this.settings.fullMapStartBlank;\r\n\r\n\t\t\t\tlatlng = new google.maps.LatLng(this.settings.defaultLat, this.settings.defaultLng);\r\n\t\t\t\tmyOptions.center = latlng;\r\n\r\n\t\t\t\t// Create the map\r\n\t\t\t\t_this.map = new google.maps.Map(document.getElementById(_this.settings.mapID), myOptions);\r\n\r\n\t\t\t\t// Re-center the map when the browser is re-sized\r\n\t\t\t\twindow.addEventListener('resize', function () {\r\n\t\t\t\t\tvar center = _this.map.getCenter();\r\n\t\t\t\t\tgoogle.maps.event.trigger(_this.map, 'resize');\r\n\t\t\t\t\t_this.map.setCenter(center);\r\n\t\t\t\t});\r\n\r\n\t\t\t\t// Only do this once\r\n\t\t\t\t_this.settings.fullMapStartBlank = false;\r\n\t\t\t\tmyOptions.zoom = originalZoom;\r\n\t\t\t} else {\r\n\t\t\t\t// If a default location is set\r\n\t\t\t\tif (this.settings.defaultLoc === true) {\r\n\t\t\t\t\tthis.defaultLocation();\r\n\t\t\t\t}\r\n\r\n\t\t\t\t// If there is already have a value in the address bar\r\n\t\t\t\tif ($.trim($('#' + this.settings.addressID).val()) !== '') {\r\n\t\t\t\t\t_this.writeDebug('Using Address Field');\r\n\t\t\t\t\t_this.processForm(null);\r\n\t\t\t\t\tdoAutoGeo = false; // No need for additional processing\r\n\t\t\t\t}\r\n\t\t\t\t// If show full map option is true\r\n\t\t\t\telse if (this.settings.fullMapStart === true && this.settings.defaultLoc === false) {\r\n\t\t\t\t\tif (\r\n\t\t\t\t\t\t(this.settings.querystringParams === true && this.getQueryString(this.settings.addressID)) ||\r\n\t\t\t\t\t\t(this.settings.querystringParams === true && this.getQueryString(this.settings.searchID)) ||\r\n\t\t\t\t\t\t(this.settings.querystringParams === true && this.getQueryString(this.settings.maxDistanceID))\r\n\t\t\t\t\t) {\r\n\t\t\t\t\t\t_this.writeDebug('Using Query String');\r\n\t\t\t\t\t\tthis.processForm(null);\r\n\t\t\t\t\t\tdoAutoGeo = false; // No need for additional processing\r\n\t\t\t\t\t} else {\r\n\t\t\t\t\t\tthis.mapping(null);\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\t\t\t}\r\n\r\n\t\t\t// HTML5 auto geolocation API option\r\n\t\t\tif (this.settings.autoGeocode === true && doAutoGeo === true) {\r\n\t\t\t\t_this.writeDebug('Auto Geo');\r\n\r\n\t\t\t\t_this.htmlGeocode();\r\n\t\t\t}\r\n\r\n\t\t\t// HTML5 geolocation API button option\r\n\t\t\tif (this.settings.autoGeocode !== null) {\r\n\t\t\t\t_this.writeDebug('Button Geo');\r\n\r\n\t\t\t\t$(document).on('click.' + pluginName, '#' + this.settings.geocodeID, function () {\r\n\t\t\t\t\t_this.htmlGeocode();\r\n\t\t\t\t});\r\n\t\t\t}\r\n\t\t},\r\n\r\n\t\t/**\r\n\t\t * Geocode function used for auto geocode setting and geocodeID button\r\n\t\t */\r\n\t\thtmlGeocode: function () {\r\n\t\t\tthis.writeDebug('htmlGeocode', arguments);\r\n\t\t\tvar _this = this;\r\n\r\n\t\t\tif (_this.settings.sessionStorage === true && window.sessionStorage && window.sessionStorage.getItem('myGeo')) {\r\n\t\t\t\t_this.writeDebug('Using Session Saved Values for GEO');\r\n\t\t\t\t_this.autoGeocodeQuery(JSON.parse(window.sessionStorage.getItem('myGeo')));\r\n\t\t\t\treturn false;\r\n\t\t\t} else if (navigator.geolocation) {\r\n\t\t\t\tnavigator.geolocation.getCurrentPosition(\r\n\t\t\t\t\tfunction (position) {\r\n\t\t\t\t\t\t_this.writeDebug('Current Position Result');\r\n\t\t\t\t\t\t// To not break autoGeocodeQuery then we create the obj to match the geolocation format\r\n\t\t\t\t\t\tvar pos = {\r\n\t\t\t\t\t\t\tcoords: {\r\n\t\t\t\t\t\t\t\tlatitude: position.coords.latitude,\r\n\t\t\t\t\t\t\t\tlongitude: position.coords.longitude,\r\n\t\t\t\t\t\t\t\taccuracy: position.coords.accuracy\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t};\r\n\r\n\t\t\t\t\t\t// Have to do this to get around scope issues\r\n\t\t\t\t\t\tif (_this.settings.sessionStorage === true && window.sessionStorage) {\r\n\t\t\t\t\t\t\twindow.sessionStorage.setItem('myGeo', JSON.stringify(pos));\r\n\t\t\t\t\t\t}\r\n\r\n\t\t\t\t\t\t// Callback\r\n\t\t\t\t\t\tif (_this.settings.callbackAutoGeoSuccess) {\r\n\t\t\t\t\t\t\t_this.settings.callbackAutoGeoSuccess.call(this, pos);\r\n\t\t\t\t\t\t}\r\n\r\n\t\t\t\t\t\t_this.autoGeocodeQuery(pos);\r\n\t\t\t\t\t},\r\n\t\t\t\t\tfunction (error) {\r\n\t\t\t\t\t\t_this._autoGeocodeError(error);\r\n\t\t\t\t\t}\r\n\t\t\t\t);\r\n\t\t\t}\r\n\t\t},\r\n\r\n\t\t/**\r\n\t\t * Geocode function used to geocode the origin (entered location)\r\n\t\t */\r\n\t\tgoogleGeocode: function (thisObj) {\r\n\t\t\tthisObj.writeDebug('googleGeocode', arguments);\r\n\t\t\tvar geocoder = new google.maps.Geocoder();\r\n\t\t\tthis.geocode = function (request, callbackFunction) {\r\n\t\t\t\tgeocoder.geocode(request, function (results, status) {\r\n\t\t\t\t\tif (status === google.maps.GeocoderStatus.OK) {\r\n\t\t\t\t\t\tvar result = {};\r\n\t\t\t\t\t\tresult.latitude = results[0].geometry.location.lat();\r\n\t\t\t\t\t\tresult.longitude = results[0].geometry.location.lng();\r\n\t\t\t\t\t\tresult.geocodeResult = results[0];\r\n\t\t\t\t\t\tcallbackFunction(result);\r\n\t\t\t\t\t} else {\r\n\t\t\t\t\t\tcallbackFunction(null);\r\n\t\t\t\t\t\tthrow new Error('Geocode was not successful for the following reason: ' + status);\r\n\t\t\t\t\t}\r\n\t\t\t\t});\r\n\t\t\t};\r\n\t\t},\r\n\r\n\t\t/**\r\n\t\t * Reverse geocode to get address for automatic options needed for directions link\r\n\t\t */\r\n\t\treverseGoogleGeocode: function (thisObj) {\r\n\t\t\tthisObj.writeDebug('reverseGoogleGeocode', arguments);\r\n\t\t\tvar geocoder = new google.maps.Geocoder();\r\n\t\t\tthis.geocode = function (request, callbackFunction) {\r\n\t\t\t\tgeocoder.geocode(request, function (results, status) {\r\n\t\t\t\t\tif (status === google.maps.GeocoderStatus.OK) {\r\n\t\t\t\t\t\tif (results[0]) {\r\n\t\t\t\t\t\t\tvar result = {};\r\n\t\t\t\t\t\t\tresult.address = results[0].formatted_address;\r\n\t\t\t\t\t\t\tresult.fullResult = results[0];\r\n\t\t\t\t\t\t\tcallbackFunction(result);\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t} else {\r\n\t\t\t\t\t\tcallbackFunction(null);\r\n\t\t\t\t\t\tthrow new Error('Reverse geocode was not successful for the following reason: ' + status);\r\n\t\t\t\t\t}\r\n\t\t\t\t});\r\n\t\t\t};\r\n\t\t},\r\n\r\n\t\t/**\r\n\t\t * Rounding function used for distances\r\n\t\t *\r\n\t\t * @param num {number} the full number\r\n\t\t * @param dec {number} the number of digits to show after the decimal\r\n\t\t *\r\n\t\t * @returns {number}\r\n\t\t */\r\n\t\troundNumber: function (num, dec) {\r\n\t\t\tthis.writeDebug('roundNumber', arguments);\r\n\t\t\treturn Math.round(num * Math.pow(10, dec)) / Math.pow(10, dec);\r\n\t\t},\r\n\r\n\t\t/**\r\n\t\t * Checks to see if the object is empty. Using this instead of $.isEmptyObject for legacy browser support\r\n\t\t *\r\n\t\t * @param obj {Object} the object to check\r\n\t\t *\r\n\t\t * @returns {boolean}\r\n\t\t */\r\n\t\tisEmptyObject: function (obj) {\r\n\t\t\tthis.writeDebug('isEmptyObject', arguments);\r\n\t\t\tfor (var key in obj) {\r\n\t\t\t\tif (obj.hasOwnProperty(key)) {\r\n\t\t\t\t\treturn false;\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t\treturn true;\r\n\t\t},\r\n\r\n\t\t/**\r\n\t\t * Checks to see if all the property values in the object are empty\r\n\t\t *\r\n\t\t * @param obj {Object} the object to check\r\n\t\t *\r\n\t\t * @returns {boolean}\r\n\t\t */\r\n\t\thasEmptyObjectVals: function (obj) {\r\n\t\t\tthis.writeDebug('hasEmptyObjectVals', arguments);\r\n\t\t\tvar objTest = true;\r\n\r\n\t\t\tfor (var key in obj) {\r\n\t\t\t\tif (obj.hasOwnProperty(key)) {\r\n\t\t\t\t\tif (obj[key] !== '' && obj[key].length !== 0) {\r\n\t\t\t\t\t\tobjTest = false;\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\t\t\t}\r\n\r\n\t\t\treturn objTest;\r\n\t\t},\r\n\r\n\t\t/**\r\n\t\t * Checks to see if only a single taxonomy group has a selected value\r\n\t\t *\r\n\t\t * @param obj {Object} the object to check\r\n\t\t * @param key {string} Key value of current filter group\r\n\t\t *\r\n\t\t * @returns {boolean}\r\n\t\t */\r\n\t\thasSingleGroupFilterVal: function (obj, key) {\r\n\t\t\tthis.writeDebug('hasSingleGroupFilterVal', arguments);\r\n\r\n\t\t\t// Copy the object so the original doesn't change.\r\n\t\t\tvar objCopy = Object.assign({}, obj);\r\n\r\n\t\t\treturn !this.hasEmptyObjectVals(objCopy[key]);\r\n\t\t},\r\n\r\n\t\t/**\r\n\t\t * Modal window close function\r\n\t\t */\r\n\t\tmodalClose: function () {\r\n\t\t\tthis.writeDebug('modalClose');\r\n\t\t\t// Callback\r\n\t\t\tif (this.settings.callbackModalClose) {\r\n\t\t\t\tthis.settings.callbackModalClose.call(this);\r\n\t\t\t}\r\n\r\n\t\t\t// Reset the filters\r\n\t\t\tfilters = {};\r\n\r\n\t\t\t// Undo category selections\r\n\t\t\t$('.' + this.settings.overlay + ' select').prop('selectedIndex', 0);\r\n\t\t\t$('.' + this.settings.overlay + ' input').prop('checked', false);\r\n\r\n\t\t\t// Hide the modal\r\n\t\t\t$('.' + this.settings.overlay).hide();\r\n\t\t},\r\n\r\n\t\t/**\r\n\t\t * Create the location variables - private\r\n\t\t *\r\n\t\t * @param loopcount {number} current marker id\r\n\t\t */\r\n\t\t_createLocationVariables: function (loopcount) {\r\n\t\t\tthis.writeDebug('_createLocationVariables', arguments);\r\n\t\t\tvar value;\r\n\t\t\tlocationData = {};\r\n\r\n\t\t\tfor (var key in locationset[loopcount]) {\r\n\t\t\t\tif (locationset[loopcount].hasOwnProperty(key)) {\r\n\t\t\t\t\tvalue = locationset[loopcount][key];\r\n\r\n\t\t\t\t\tif (key === 'distance' || key === 'altdistance') {\r\n\t\t\t\t\t\tvalue = this.roundNumber(value, 2);\r\n\t\t\t\t\t}\r\n\r\n\t\t\t\t\tlocationData[key] = value;\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t},\r\n\r\n\t\t/**\r\n\t\t * Location alphabetical sorting function\r\n\t\t *\r\n\t\t * @param locationsarray {array} locationset array\r\n\t\t */\r\n\t\tsortAlpha: function (locationsarray) {\r\n\t\t\tthis.writeDebug('sortAlpha', arguments);\r\n\t\t\tvar property =\r\n\t\t\t\tthis.settings.sortBy.hasOwnProperty('prop') && typeof this.settings.sortBy.prop !== 'undefined' ? this.settings.sortBy.prop : 'name';\r\n\r\n\t\t\tif (this.settings.sortBy.hasOwnProperty('order') && this.settings.sortBy.order.toString() === 'desc') {\r\n\t\t\t\tlocationsarray.sort(function (a, b) {\r\n\t\t\t\t\treturn b[property].toLowerCase().localeCompare(a[property].toLowerCase());\r\n\t\t\t\t});\r\n\t\t\t} else {\r\n\t\t\t\tlocationsarray.sort(function (a, b) {\r\n\t\t\t\t\treturn a[property].toLowerCase().localeCompare(b[property].toLowerCase());\r\n\t\t\t\t});\r\n\t\t\t}\r\n\t\t},\r\n\r\n\t\t/**\r\n\t\t * Location date sorting function\r\n\t\t *\r\n\t\t * @param locationsarray {array} locationset array\r\n\t\t */\r\n\t\tsortDate: function (locationsarray) {\r\n\t\t\tthis.writeDebug('sortDate', arguments);\r\n\t\t\tvar property =\r\n\t\t\t\tthis.settings.sortBy.hasOwnProperty('prop') && typeof this.settings.sortBy.prop !== 'undefined' ? this.settings.sortBy.prop : 'date';\r\n\r\n\t\t\tif (this.settings.sortBy.hasOwnProperty('order') && this.settings.sortBy.order.toString() === 'desc') {\r\n\t\t\t\tlocationsarray.sort(function (a, b) {\r\n\t\t\t\t\treturn new Date(b[property]).getTime() - new Date(a[property]).getTime();\r\n\t\t\t\t});\r\n\t\t\t} else {\r\n\t\t\t\tlocationsarray.sort(function (a, b) {\r\n\t\t\t\t\treturn new Date(a[property]).getTime() - new Date(b[property]).getTime();\r\n\t\t\t\t});\r\n\t\t\t}\r\n\t\t},\r\n\r\n\t\t/**\r\n\t\t * Location distance sorting function\r\n\t\t *\r\n\t\t * @param locationsarray {array} locationset array\r\n\t\t * @param distanceOverride {boolean} Force sort by distance\r\n\t\t */\r\n\t\tsortNumerically: function (locationsarray, distanceOverride) {\r\n\t\t\tthis.writeDebug('sortNumerically', arguments);\r\n\t\t\tvar property =\r\n\t\t\t\tthis.settings.sortBy !== null && this.settings.sortBy.hasOwnProperty('prop') && typeof this.settings.sortBy.prop !== 'undefined'\r\n\t\t\t\t\t? this.settings.sortBy.prop\r\n\t\t\t\t\t: 'distance';\r\n\r\n\t\t\tif (typeof distanceOverride !== 'undefined' && distanceOverride === true) {\r\n\t\t\t\tproperty = 'distance';\r\n\t\t\t}\r\n\r\n\t\t\tif (this.settings.sortBy !== null && this.settings.sortBy.hasOwnProperty('order') && this.settings.sortBy.order.toString() === 'desc') {\r\n\t\t\t\tlocationsarray.sort(function (a, b) {\r\n\t\t\t\t\treturn b[property] < a[property] ? -1 : b[property] > a[property] ? 1 : 0;\r\n\t\t\t\t});\r\n\t\t\t} else {\r\n\t\t\t\tlocationsarray.sort(function (a, b) {\r\n\t\t\t\t\treturn a[property] < b[property] ? -1 : a[property] > b[property] ? 1 : 0;\r\n\t\t\t\t});\r\n\t\t\t}\r\n\t\t},\r\n\r\n\t\t/**\r\n\t\t * Alternative sorting setup\r\n\t\t *\r\n\t\t * @param locationsarray {array} locationset array\r\n\t\t */\r\n\t\tsortCustom: function (locationsarray) {\r\n\t\t\tthis.writeDebug('sortCustom', arguments);\r\n\r\n\t\t\t// Alphabetically, date, or numeric\r\n\t\t\tif (this.settings.sortBy.hasOwnProperty('method') && this.settings.sortBy.method.toString() === 'alpha') {\r\n\t\t\t\tthis.sortAlpha(locationsarray);\r\n\t\t\t} else if (this.settings.sortBy.hasOwnProperty('method') && this.settings.sortBy.method.toString() === 'date') {\r\n\t\t\t\tthis.sortDate(locationsarray);\r\n\t\t\t} else {\r\n\t\t\t\tthis.sortNumerically(locationsarray);\r\n\t\t\t}\r\n\t\t},\r\n\r\n\t\t/**\r\n\t\t * Run the matching between regular expression filters and string value\r\n\t\t *\r\n\t\t * @param filter {array} One or multiple filters to apply\r\n\t\t * @param val {string} Value to compare\r\n\t\t * @param inclusive {boolean} Inclusive (default) or exclusive\r\n\t\t *\r\n\t\t * @returns {boolean}\r\n\t\t */\r\n\t\tfilterMatching: function (filter, val, inclusive) {\r\n\t\t\tthis.writeDebug('inclusiveFilter', arguments);\r\n\t\t\tinclusive = typeof inclusive !== 'undefined' ? inclusive : true;\r\n\t\t\tvar applyFilters;\r\n\r\n\t\t\t// Undefined check.\r\n\t\t\tif (typeof val === 'undefined') {\r\n\t\t\t\treturn false;\r\n\t\t\t}\r\n\r\n\t\t\t// Modify the join depending on inclusive (AND) vs exclusive (OR).\r\n\t\t\tif (true === inclusive) {\r\n\t\t\t\tapplyFilters = filter.join('');\r\n\t\t\t} else {\r\n\t\t\t\tapplyFilters = filter.join('|');\r\n\t\t\t}\r\n\r\n\t\t\tif (new RegExp(applyFilters, 'i').test(val.replace(/([.*+?^=!:${}()|\\[\\]\\/\\\\]|&\\s+)/g, ''))) {\r\n\t\t\t\treturn true;\r\n\t\t\t}\r\n\r\n\t\t\treturn false;\r\n\t\t},\r\n\r\n\t\t/**\r\n\t\t * Filter the data with Regex\r\n\t\t *\r\n\t\t * @param data {array} data array to check for filter values\r\n\t\t * @param filters {Object} taxonomy filters object\r\n\t\t *\r\n\t\t * @returns {boolean}\r\n\t\t */\r\n\t\tfilterData: function (data, filters) {\r\n\t\t\tthis.writeDebug('filterData', arguments);\r\n\t\t\tvar filterTest = true;\r\n\r\n\t\t\tfor (var k in filters) {\r\n\t\t\t\tif (filters.hasOwnProperty(k)) {\r\n\t\t\t\t\tvar testResults = [];\r\n\r\n\t\t\t\t\tfor (var l = 0; l < filters[k].length; l++) {\r\n\t\t\t\t\t\t// Exclusive filtering\r\n\t\t\t\t\t\tif (\r\n\t\t\t\t\t\t\tthis.settings.exclusiveFiltering === true ||\r\n\t\t\t\t\t\t\t(this.settings.exclusiveTax !== null && Array.isArray(this.settings.exclusiveTax) && this.settings.exclusiveTax.indexOf(k) !== -1)\r\n\t\t\t\t\t\t) {\r\n\t\t\t\t\t\t\ttestResults[l] = this.filterMatching(filters[k], data[k], false);\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t\t// Inclusive filtering\r\n\t\t\t\t\t\telse {\r\n\t\t\t\t\t\t\ttestResults[l] = this.filterMatching(filters[k], data[k]);\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t}\r\n\r\n\t\t\t\t\t// First handle name search, then standard filtering.\r\n\t\t\t\t\tif (typeof nameAttrs !== 'undefined' && nameAttrs.indexOf(k) !== -1 && testResults.indexOf(true) !== -1) {\r\n\t\t\t\t\t\treturn true;\r\n\t\t\t\t\t} else {\r\n\t\t\t\t\t\tif (testResults.indexOf(true) === -1) {\r\n\t\t\t\t\t\t\tfilterTest = false;\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\t\t\t}\r\n\r\n\t\t\treturn filterTest;\r\n\t\t},\r\n\r\n\t\t/**\r\n\t\t * Build pagination numbers and next/prev links - private\r\n\t\t *\r\n\t\t * @param currentPage {number}\r\n\t\t * @param totalPages {number}\r\n\t\t *\r\n\t\t * @returns {string}\r\n\t\t */\r\n\t\t_paginationOutput: function (currentPage, totalPages) {\r\n\t\t\tthis.writeDebug('_paginationOutput', arguments);\r\n\r\n\t\t\tcurrentPage = parseFloat(currentPage);\r\n\t\t\tvar output = '';\r\n\t\t\tvar nextPage = currentPage + 1;\r\n\t\t\tvar prevPage = currentPage - 1;\r\n\r\n\t\t\t// Previous page\r\n\t\t\tif (currentPage > 0) {\r\n\t\t\t\toutput += '<li class=\"bh-sl-next-prev\" data-page=\"' + prevPage + '\">' + this.settings.prevPage + '</li>';\r\n\t\t\t}\r\n\r\n\t\t\t// Add the numbers\r\n\t\t\tfor (var p = 0; p < Math.ceil(totalPages); p++) {\r\n\t\t\t\tvar n = p + 1;\r\n\r\n\t\t\t\tif (p === currentPage) {\r\n\t\t\t\t\toutput += '<li class=\"bh-sl-current\" data-page=\"' + p + '\">' + n + '</li>';\r\n\t\t\t\t} else {\r\n\t\t\t\t\toutput += '<li data-page=\"' + p + '\">' + n + '</li>';\r\n\t\t\t\t}\r\n\t\t\t}\r\n\r\n\t\t\t// Next page\r\n\t\t\tif (nextPage < totalPages) {\r\n\t\t\t\toutput += '<li class=\"bh-sl-next-prev\" data-page=\"' + nextPage + '\">' + this.settings.nextPage + '</li>';\r\n\t\t\t}\r\n\r\n\t\t\treturn output;\r\n\t\t},\r\n\r\n\t\t/**\r\n\t\t * Set up the pagination pages\r\n\t\t *\r\n\t\t * @param currentPage {number} optional current page\r\n\t\t */\r\n\t\tpaginationSetup: function (currentPage) {\r\n\t\t\tthis.writeDebug('paginationSetup', arguments);\r\n\t\t\tvar pagesOutput = '';\r\n\t\t\tvar totalPages;\r\n\t\t\tvar $paginationList = $('.bh-sl-pagination-container .bh-sl-pagination');\r\n\r\n\t\t\t// Total pages\r\n\t\t\tif (this.settings.storeLimit === -1 || locationset.length < this.settings.storeLimit) {\r\n\t\t\t\ttotalPages = locationset.length / this.settings.locationsPerPage;\r\n\t\t\t} else {\r\n\t\t\t\ttotalPages = this.settings.storeLimit / this.settings.locationsPerPage;\r\n\t\t\t}\r\n\r\n\t\t\t// Current page check\r\n\t\t\tif (typeof currentPage === 'undefined') {\r\n\t\t\t\tcurrentPage = 0;\r\n\t\t\t}\r\n\r\n\t\t\t// Initial pagination setup\r\n\t\t\tif ($paginationList.length === 0) {\r\n\t\t\t\tpagesOutput = this._paginationOutput(currentPage, totalPages);\r\n\t\t\t}\r\n\t\t\t// Update pagination on page change\r\n\t\t\telse {\r\n\t\t\t\t// Remove the old pagination\r\n\t\t\t\t$paginationList.empty();\r\n\r\n\t\t\t\t// Add the numbers\r\n\t\t\t\tpagesOutput = this._paginationOutput(currentPage, totalPages);\r\n\t\t\t}\r\n\r\n\t\t\t$paginationList.append(pagesOutput);\r\n\t\t},\r\n\r\n\t\t/**\r\n\t\t * Marker image setup\r\n\t\t *\r\n\t\t * @param markerUrl {string} path to marker image\r\n\t\t * @param markerWidth {number} width of marker\r\n\t\t * @param markerHeight {number} height of marker\r\n\t\t *\r\n\t\t * @returns {Object} Google Maps icon object\r\n\t\t */\r\n\t\tmarkerImage: function (markerUrl, markerWidth, markerHeight) {\r\n\t\t\tthis.writeDebug('markerImage', arguments);\r\n\t\t\tvar markerImg;\r\n\r\n\t\t\t// User defined marker dimensions\r\n\t\t\tif (typeof markerWidth !== 'undefined' && typeof markerHeight !== 'undefined') {\r\n\t\t\t\tmarkerImg = {\r\n\t\t\t\t\turl: markerUrl,\r\n\t\t\t\t\tsize: new google.maps.Size(markerWidth, markerHeight),\r\n\t\t\t\t\tscaledSize: new google.maps.Size(markerWidth, markerHeight)\r\n\t\t\t\t};\r\n\t\t\t}\r\n\t\t\t// Default marker dimensions: 32px x 32px\r\n\t\t\telse {\r\n\t\t\t\tmarkerImg = {\r\n\t\t\t\t\turl: markerUrl,\r\n\t\t\t\t\tsize: new google.maps.Size(32, 32),\r\n\t\t\t\t\tscaledSize: new google.maps.Size(32, 32)\r\n\t\t\t\t};\r\n\t\t\t}\r\n\r\n\t\t\treturn markerImg;\r\n\t\t},\r\n\r\n\t\t/**\r\n\t\t * Map marker setup\r\n\t\t *\r\n\t\t * @param point {Object} LatLng of current location\r\n\t\t * @param name {string} location name\r\n\t\t * @param address {string} location address\r\n\t\t * @param letter {string} optional letter used for front-end identification and correlation between list and\r\n\t\t *     points\r\n\t\t * @param map {Object} the Google Map\r\n\t\t * @param category {string} location category/categories\r\n\t\t *\r\n\t\t * @returns {Object} Google Maps marker\r\n\t\t */\r\n\t\tcreateMarker: function (point, name, address, letter, map, category) {\r\n\t\t\tthis.writeDebug('createMarker', arguments);\r\n\t\t\tvar marker, markerImg, letterMarkerImg;\r\n\t\t\tvar categories = [];\r\n\r\n\t\t\t// Custom multi-marker image override (different markers for different categories\r\n\t\t\tif (this.settings.catMarkers !== null) {\r\n\t\t\t\tif (typeof category !== 'undefined') {\r\n\t\t\t\t\t// Multiple categories\r\n\t\t\t\t\tif (category.indexOf(',') !== -1) {\r\n\t\t\t\t\t\t// Break the category variable into an array if there are multiple categories for the location\r\n\t\t\t\t\t\tcategories = category.split(',');\r\n\t\t\t\t\t\t// With multiple categories the color will be determined by the last matched category in the data\r\n\t\t\t\t\t\tfor (var i = 0; i < categories.length; i++) {\r\n\t\t\t\t\t\t\tif (categories[i] in this.settings.catMarkers) {\r\n\t\t\t\t\t\t\t\tmarkerImg = this.markerImage(\r\n\t\t\t\t\t\t\t\t\tthis.settings.catMarkers[categories[i]][0],\r\n\t\t\t\t\t\t\t\t\tparseInt(this.settings.catMarkers[categories[i]][1]),\r\n\t\t\t\t\t\t\t\t\tparseInt(this.settings.catMarkers[categories[i]][2])\r\n\t\t\t\t\t\t\t\t);\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t}\r\n\t\t\t\t\t// Single category\r\n\t\t\t\t\telse {\r\n\t\t\t\t\t\tif (category in this.settings.catMarkers) {\r\n\t\t\t\t\t\t\tmarkerImg = this.markerImage(\r\n\t\t\t\t\t\t\t\tthis.settings.catMarkers[category][0],\r\n\t\t\t\t\t\t\t\tparseInt(this.settings.catMarkers[category][1]),\r\n\t\t\t\t\t\t\t\tparseInt(this.settings.catMarkers[category][2])\r\n\t\t\t\t\t\t\t);\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\t\t\t}\r\n\r\n\t\t\t// Custom single marker image override\r\n\t\t\tif (this.settings.markerImg !== null) {\r\n\t\t\t\tif (this.settings.markerDim === null) {\r\n\t\t\t\t\tmarkerImg = this.markerImage(this.settings.markerImg);\r\n\t\t\t\t} else {\r\n\t\t\t\t\tmarkerImg = this.markerImage(this.settings.markerImg, this.settings.markerDim.width, this.settings.markerDim.height);\r\n\t\t\t\t}\r\n\t\t\t}\r\n\r\n\t\t\t// Marker setup\r\n\t\t\tif (this.settings.callbackCreateMarker) {\r\n\t\t\t\t// Marker override callback\r\n\t\t\t\tmarker = this.settings.callbackCreateMarker.call(this, map, point, letter, category);\r\n\t\t\t} else {\r\n\t\t\t\t// Create the default markers\r\n\t\t\t\tif (\r\n\t\t\t\t\tthis.settings.disableAlphaMarkers === true ||\r\n\t\t\t\t\tthis.settings.storeLimit === -1 ||\r\n\t\t\t\t\tthis.settings.storeLimit > 26 ||\r\n\t\t\t\t\tthis.settings.catMarkers !== null ||\r\n\t\t\t\t\tthis.settings.markerImg !== null ||\r\n\t\t\t\t\t(this.settings.fullMapStart === true &&\r\n\t\t\t\t\t\tfirstRun === true &&\r\n\t\t\t\t\t\t(isNaN(this.settings.fullMapStartListLimit) || this.settings.fullMapStartListLimit > 26 || this.settings.fullMapStartListLimit === -1))\r\n\t\t\t\t) {\r\n\t\t\t\t\tmarker = new google.maps.Marker({\r\n\t\t\t\t\t\tdraggable: false,\r\n\t\t\t\t\t\ticon: markerImg, // Reverts to default marker if nothing is passed\r\n\t\t\t\t\t\tmap: map,\r\n\t\t\t\t\t\toptimized: false,\r\n\t\t\t\t\t\tposition: point,\r\n\t\t\t\t\t\ttitle: name\r\n\t\t\t\t\t});\r\n\t\t\t\t} else {\r\n\t\t\t\t\t// Letter markers\r\n\t\t\t\t\tmarker = new google.maps.Marker({\r\n\t\t\t\t\t\tdraggable: false,\r\n\t\t\t\t\t\tlabel: letter,\r\n\t\t\t\t\t\tmap: map,\r\n\t\t\t\t\t\toptimized: false,\r\n\t\t\t\t\t\tposition: point,\r\n\t\t\t\t\t\ttitle: name\r\n\t\t\t\t\t});\r\n\t\t\t\t}\r\n\t\t\t}\r\n\r\n\t\t\treturn marker;\r\n\t\t},\r\n\r\n\t\t/**\r\n\t\t * Define the location data for the templates - private\r\n\t\t *\r\n\t\t * @param currentMarker {Object} Google Maps marker\r\n\t\t * @param storeStart {number} optional first location on the current page\r\n\t\t * @param page {number} optional current page\r\n\t\t *\r\n\t\t * @returns {Object} extended location data object\r\n\t\t */\r\n\t\t_defineLocationData: function (currentMarker, storeStart, page) {\r\n\t\t\tthis.writeDebug('_defineLocationData', arguments);\r\n\t\t\tvar indicator = '';\r\n\t\t\tthis._createLocationVariables(currentMarker.get('id'));\r\n\r\n\t\t\tvar altDistLength, distLength;\r\n\r\n\t\t\tif (locationData.distance <= 1) {\r\n\t\t\t\tif (this.settings.lengthUnit === 'km') {\r\n\t\t\t\t\tdistLength = this.settings.kilometerLang;\r\n\t\t\t\t\taltDistLength = this.settings.mileLang;\r\n\t\t\t\t} else {\r\n\t\t\t\t\tdistLength = this.settings.mileLang;\r\n\t\t\t\t\taltDistLength = this.settings.kilometerLang;\r\n\t\t\t\t}\r\n\t\t\t} else {\r\n\t\t\t\tif (this.settings.lengthUnit === 'km') {\r\n\t\t\t\t\tdistLength = this.settings.kilometersLang;\r\n\t\t\t\t\taltDistLength = this.settings.milesLang;\r\n\t\t\t\t} else {\r\n\t\t\t\t\tdistLength = this.settings.milesLang;\r\n\t\t\t\t\taltDistLength = this.settings.kilometersLang;\r\n\t\t\t\t}\r\n\t\t\t}\r\n\r\n\t\t\t// Set up alpha character\r\n\t\t\tvar markerId = currentMarker.get('id');\r\n\t\t\t// Use dot markers instead of alpha if there are more than 26 locations\r\n\t\t\tif (\r\n\t\t\t\tthis.settings.disableAlphaMarkers === true ||\r\n\t\t\t\tthis.settings.storeLimit === -1 ||\r\n\t\t\t\tthis.settings.storeLimit > 26 ||\r\n\t\t\t\t(this.settings.fullMapStart === true &&\r\n\t\t\t\t\tfirstRun === true &&\r\n\t\t\t\t\t(isNaN(this.settings.fullMapStartListLimit) || this.settings.fullMapStartListLimit > 26 || this.settings.fullMapStartListLimit === -1))\r\n\t\t\t) {\r\n\t\t\t\tindicator = markerId + 1;\r\n\t\t\t} else {\r\n\t\t\t\tif (page > 0) {\r\n\t\t\t\t\tindicator = String.fromCharCode('A'.charCodeAt(0) + (storeStart + markerId));\r\n\t\t\t\t} else {\r\n\t\t\t\t\tindicator = String.fromCharCode('A'.charCodeAt(0) + markerId);\r\n\t\t\t\t}\r\n\t\t\t}\r\n\r\n\t\t\t// Define location data\r\n\t\t\treturn {\r\n\t\t\t\tlocation: [\r\n\t\t\t\t\t$.extend(locationData, {\r\n\t\t\t\t\t\tmarkerid: markerId,\r\n\t\t\t\t\t\tmarker: indicator,\r\n\t\t\t\t\t\taltlength: altDistLength,\r\n\t\t\t\t\t\tlength: distLength,\r\n\t\t\t\t\t\torigin: originalOrigin\r\n\t\t\t\t\t})\r\n\t\t\t\t]\r\n\t\t\t};\r\n\t\t},\r\n\r\n\t\t/**\r\n\t\t * Set up the list templates\r\n\t\t *\r\n\t\t * @param marker {Object} Google Maps marker\r\n\t\t * @param storeStart {number} optional first location on the current page\r\n\t\t * @param page {number} optional current page\r\n\t\t */\r\n\t\tlistSetup: function (marker, storeStart, page) {\r\n\t\t\tthis.writeDebug('listSetup', arguments);\r\n\t\t\t// Define the location data\r\n\t\t\tvar locations = this._defineLocationData(marker, storeStart, page);\r\n\r\n\t\t\t// Set up the list template with the location data\r\n\t\t\tvar listHtml = listTemplate(locations);\r\n\t\t\t$('.' + this.settings.locationList + ' > ul').append(listHtml);\r\n\t\t},\r\n\r\n\t\t/**\r\n\t\t * Change the selected marker image\r\n\t\t *\r\n\t\t * @param marker {Object} Google Maps marker object\r\n\t\t */\r\n\t\tchangeSelectedMarker: function (marker) {\r\n\t\t\tvar markerImg;\r\n\r\n\t\t\t// Reset the previously selected marker\r\n\t\t\tif (typeof prevSelectedMarkerAfter !== 'undefined') {\r\n\t\t\t\tprevSelectedMarkerAfter.setIcon(prevSelectedMarkerBefore);\r\n\t\t\t}\r\n\r\n\t\t\t// Change the selected marker icon\r\n\t\t\tif (this.settings.selectedMarkerImgDim === null) {\r\n\t\t\t\tmarkerImg = this.markerImage(this.settings.selectedMarkerImg);\r\n\t\t\t} else {\r\n\t\t\t\tmarkerImg = this.markerImage(\r\n\t\t\t\t\tthis.settings.selectedMarkerImg,\r\n\t\t\t\t\tthis.settings.selectedMarkerImgDim.width,\r\n\t\t\t\t\tthis.settings.selectedMarkerImgDim.height\r\n\t\t\t\t);\r\n\t\t\t}\r\n\r\n\t\t\t// Save the marker before switching it\r\n\t\t\tprevSelectedMarkerBefore = marker.icon;\r\n\r\n\t\t\tmarker.setIcon(markerImg);\r\n\r\n\t\t\t// Save the marker to a variable so it can be reverted when another marker is clicked\r\n\t\t\tprevSelectedMarkerAfter = marker;\r\n\t\t},\r\n\r\n\t\t/**\r\n\t\t * Create the infowindow\r\n\t\t *\r\n\t\t * @param marker {Object} Google Maps marker object\r\n\t\t * @param location {string} indicates if the list or a map marker was clicked\r\n\t\t * @param infowindow Google Maps InfoWindow constructor\r\n\t\t * @param storeStart {number}\r\n\t\t * @param page {number}\r\n\t\t */\r\n\t\tcreateInfowindow: function (marker, location, infowindow, storeStart, page) {\r\n\t\t\tthis.writeDebug('createInfowindow', arguments);\r\n\t\t\tvar _this = this;\r\n\t\t\t// Define the location data\r\n\t\t\tvar locations = this._defineLocationData(marker, storeStart, page);\r\n\r\n\t\t\t// Set up the infowindow template with the location data\r\n\t\t\tvar formattedAddress = infowindowTemplate(locations);\r\n\r\n\t\t\t// Opens the infowindow when list item is clicked\r\n\t\t\tif (location === 'left') {\r\n\t\t\t\tinfowindow.setContent(formattedAddress);\r\n\t\t\t\tinfowindow.open(marker.get('map'), marker);\r\n\t\t\t}\r\n\t\t\t// Opens the infowindow when the marker is clicked\r\n\t\t\telse {\r\n\t\t\t\tgoogle.maps.event.addListener(marker, 'click', function () {\r\n\t\t\t\t\tinfowindow.setContent(formattedAddress);\r\n\t\t\t\t\tinfowindow.open(marker.get('map'), marker);\r\n\t\t\t\t\t// Focus on the list\r\n\t\t\t\t\tvar markerId = marker.get('id');\r\n\t\t\t\t\tvar $selectedLocation = $('.' + _this.settings.locationList + ' li[data-markerid=' + markerId + ']');\r\n\r\n\t\t\t\t\tif ($selectedLocation.length > 0) {\r\n\t\t\t\t\t\t// Marker click callback\r\n\t\t\t\t\t\tif (_this.settings.callbackMarkerClick) {\r\n\t\t\t\t\t\t\t_this.settings.callbackMarkerClick.call(this, marker, markerId, $selectedLocation, locationset[markerId], _this.map);\r\n\t\t\t\t\t\t}\r\n\r\n\t\t\t\t\t\t$('.' + _this.settings.locationList + ' li').removeClass('list-focus');\r\n\t\t\t\t\t\t$selectedLocation.addClass('list-focus');\r\n\r\n\t\t\t\t\t\t// Scroll list to selected marker\r\n\t\t\t\t\t\tvar $container = $('.' + _this.settings.locationList);\r\n\t\t\t\t\t\t$container.animate({\r\n\t\t\t\t\t\t\tscrollTop: $selectedLocation.offset().top - $container.offset().top + $container.scrollTop()\r\n\t\t\t\t\t\t});\r\n\t\t\t\t\t}\r\n\r\n\t\t\t\t\t// Custom selected marker override\r\n\t\t\t\t\tif (_this.settings.selectedMarkerImg !== null) {\r\n\t\t\t\t\t\t_this.changeSelectedMarker(marker);\r\n\t\t\t\t\t}\r\n\t\t\t\t});\r\n\t\t\t}\r\n\t\t},\r\n\r\n\t\t/**\r\n\t\t * HTML5 geocoding function for automatic location detection\r\n\t\t *\r\n\t\t * @param position {Object} coordinates\r\n\t\t */\r\n\t\tautoGeocodeQuery: function (position) {\r\n\t\t\tthis.writeDebug('autoGeocodeQuery', arguments);\r\n\t\t\tvar _this = this,\r\n\t\t\t\tdistance = null,\r\n\t\t\t\t$distanceInput = $('#' + this.settings.maxDistanceID),\r\n\t\t\t\toriginAddress;\r\n\r\n\t\t\t// Query string parameters\r\n\t\t\tif (this.settings.querystringParams === true) {\r\n\t\t\t\t// Check for distance query string parameters\r\n\t\t\t\tif (this.getQueryString(this.settings.maxDistanceID)) {\r\n\t\t\t\t\tdistance = this.getQueryString(this.settings.maxDistanceID);\r\n\r\n\t\t\t\t\tif ($distanceInput.val() !== '') {\r\n\t\t\t\t\t\tdistance = $distanceInput.val();\r\n\t\t\t\t\t}\r\n\t\t\t\t} else {\r\n\t\t\t\t\t// Get the distance if set\r\n\t\t\t\t\tif (this.settings.maxDistance === true) {\r\n\t\t\t\t\t\tdistance = $distanceInput.val() || '';\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\t\t\t} else {\r\n\t\t\t\t// Get the distance if set\r\n\t\t\t\tif (this.settings.maxDistance === true) {\r\n\t\t\t\t\tdistance = $distanceInput.val() || '';\r\n\t\t\t\t}\r\n\t\t\t}\r\n\r\n\t\t\t// The address needs to be determined for the directions link\r\n\t\t\tvar r = new this.reverseGoogleGeocode(this);\r\n\t\t\tvar latlng = new google.maps.LatLng(position.coords.latitude, position.coords.longitude);\r\n\t\t\tr.geocode({ latLng: latlng }, function (data) {\r\n\t\t\t\tif (data !== null) {\r\n\t\t\t\t\toriginAddress = addressInput = data.address;\r\n\t\t\t\t\tolat = mappingObj.lat = position.coords.latitude;\r\n\t\t\t\t\tolng = mappingObj.lng = position.coords.longitude;\r\n\t\t\t\t\tmappingObj.origin = originAddress;\r\n\t\t\t\t\tmappingObj.distance = distance;\r\n\t\t\t\t\t_this.mapping(mappingObj);\r\n\r\n\t\t\t\t\t// Fill in the search box.\r\n\t\t\t\t\tif (typeof originAddress !== 'undefined') {\r\n\t\t\t\t\t\t$('#' + _this.settings.addressID).val(originAddress);\r\n\t\t\t\t\t}\r\n\t\t\t\t} else {\r\n\t\t\t\t\t// Unable to geocode\r\n\t\t\t\t\t_this.notify(_this.settings.addressErrorAlert);\r\n\t\t\t\t}\r\n\t\t\t});\r\n\t\t},\r\n\r\n\t\t/**\r\n\t\t * Handle autoGeocode failure - private\r\n\t\t *\r\n\t\t */\r\n\t\t_autoGeocodeError: function () {\r\n\t\t\tthis.writeDebug('_autoGeocodeError');\r\n\t\t\t// If automatic detection doesn't work show an error\r\n\t\t\tthis.notify(this.settings.autoGeocodeErrorAlert);\r\n\t\t},\r\n\r\n\t\t/**\r\n\t\t * Default location method\r\n\t\t */\r\n\t\tdefaultLocation: function () {\r\n\t\t\tthis.writeDebug('defaultLocation');\r\n\t\t\tvar _this = this,\r\n\t\t\t\tdistance = null,\r\n\t\t\t\t$distanceInput = $('#' + this.settings.maxDistanceID),\r\n\t\t\t\toriginAddress;\r\n\r\n\t\t\t// Query string parameters\r\n\t\t\tif (this.settings.querystringParams === true) {\r\n\t\t\t\t// Check for distance query string parameters\r\n\t\t\t\tif (this.getQueryString(this.settings.maxDistanceID)) {\r\n\t\t\t\t\tdistance = this.getQueryString(this.settings.maxDistanceID);\r\n\r\n\t\t\t\t\tif ($distanceInput.val() !== '') {\r\n\t\t\t\t\t\tdistance = $distanceInput.val();\r\n\t\t\t\t\t}\r\n\t\t\t\t} else {\r\n\t\t\t\t\t// Get the distance if set\r\n\t\t\t\t\tif (this.settings.maxDistance === true) {\r\n\t\t\t\t\t\tdistance = $distanceInput.val() || '';\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\t\t\t} else {\r\n\t\t\t\t// Get the distance if set\r\n\t\t\t\tif (this.settings.maxDistance === true) {\r\n\t\t\t\t\tdistance = $distanceInput.val() || '';\r\n\t\t\t\t}\r\n\t\t\t}\r\n\r\n\t\t\t// The address needs to be determined for the directions link\r\n\t\t\tvar r = new this.reverseGoogleGeocode(this);\r\n\t\t\tvar latlng = new google.maps.LatLng(this.settings.defaultLat, this.settings.defaultLng);\r\n\t\t\tr.geocode({ latLng: latlng }, function (data) {\r\n\t\t\t\tif (data !== null) {\r\n\t\t\t\t\toriginAddress = addressInput = data.address;\r\n\t\t\t\t\tolat = mappingObj.lat = _this.settings.defaultLat;\r\n\t\t\t\t\tolng = mappingObj.lng = _this.settings.defaultLng;\r\n\t\t\t\t\tmappingObj.distance = distance;\r\n\t\t\t\t\tmappingObj.origin = originAddress;\r\n\t\t\t\t\t_this.mapping(mappingObj);\r\n\t\t\t\t} else {\r\n\t\t\t\t\t// Unable to geocode\r\n\t\t\t\t\t_this.notify(_this.settings.addressErrorAlert);\r\n\t\t\t\t}\r\n\t\t\t});\r\n\t\t},\r\n\r\n\t\t/**\r\n\t\t * Change the page\r\n\t\t *\r\n\t\t * @param newPage {number} page to change to\r\n\t\t */\r\n\t\tpaginationChange: function (newPage) {\r\n\t\t\tthis.writeDebug('paginationChange', arguments);\r\n\r\n\t\t\t// Page change callback\r\n\t\t\tif (this.settings.callbackPageChange) {\r\n\t\t\t\tthis.settings.callbackPageChange.call(this, newPage);\r\n\t\t\t}\r\n\r\n\t\t\tmappingObj.page = newPage;\r\n\t\t\tthis.mapping(mappingObj);\r\n\t\t},\r\n\r\n\t\t/**\r\n\t\t * Get the address by marker ID\r\n\t\t *\r\n\t\t * @param markerID {number} location ID\r\n\t\t *\r\n\t\t * @returns {string} formatted address\r\n\t\t */\r\n\t\tgetAddressByMarker: function (markerID) {\r\n\t\t\tthis.writeDebug('getAddressByMarker', arguments);\r\n\t\t\tvar formattedAddress = '';\r\n\t\t\t// Set up formatted address\r\n\t\t\tif (locationset[markerID].address) {\r\n\t\t\t\tformattedAddress += locationset[markerID].address + ' ';\r\n\t\t\t}\r\n\t\t\tif (locationset[markerID].address2) {\r\n\t\t\t\tformattedAddress += locationset[markerID].address2 + ' ';\r\n\t\t\t}\r\n\t\t\tif (locationset[markerID].city) {\r\n\t\t\t\tformattedAddress += locationset[markerID].city + ', ';\r\n\t\t\t}\r\n\t\t\tif (locationset[markerID].state) {\r\n\t\t\t\tformattedAddress += locationset[markerID].state + ' ';\r\n\t\t\t}\r\n\t\t\tif (locationset[markerID].postal) {\r\n\t\t\t\tformattedAddress += locationset[markerID].postal + ' ';\r\n\t\t\t}\r\n\t\t\tif (locationset[markerID].country) {\r\n\t\t\t\tformattedAddress += locationset[markerID].country + ' ';\r\n\t\t\t}\r\n\r\n\t\t\treturn formattedAddress;\r\n\t\t},\r\n\r\n\t\t/**\r\n\t\t * Clear the markers from the map\r\n\t\t */\r\n\t\tclearMarkers: function () {\r\n\t\t\tthis.writeDebug('clearMarkers');\r\n\t\t\tvar locationsLimit = null;\r\n\r\n\t\t\tif (locationset.length < this.settings.storeLimit) {\r\n\t\t\t\tlocationsLimit = locationset.length;\r\n\t\t\t} else {\r\n\t\t\t\tlocationsLimit = this.settings.storeLimit;\r\n\t\t\t}\r\n\r\n\t\t\tfor (var i = 0; i < locationsLimit; i++) {\r\n\t\t\t\tmarkers[i].setMap(null);\r\n\t\t\t}\r\n\t\t},\r\n\r\n\t\t/**\r\n\t\t * Handle inline direction requests\r\n\t\t *\r\n\t\t * @param origin {string} origin address\r\n\t\t * @param locID {number} location ID\r\n\t\t * @param map {Object} Google Map\r\n\t\t */\r\n\t\tdirectionsRequest: function (origin, locID, map) {\r\n\t\t\tthis.writeDebug('directionsRequest', arguments);\r\n\r\n\t\t\t// Directions request callback\r\n\t\t\tif (this.settings.callbackDirectionsRequest) {\r\n\t\t\t\tthis.settings.callbackDirectionsRequest.call(this, origin, locID, map, locationset[locID]);\r\n\t\t\t}\r\n\r\n\t\t\tvar destination = this.getAddressByMarker(locID);\r\n\r\n\t\t\tif (destination) {\r\n\t\t\t\t// Hide the location list\r\n\t\t\t\t$('.' + this.settings.locationList + ' ul').hide();\r\n\t\t\t\t// Remove the markers\r\n\t\t\t\tthis.clearMarkers();\r\n\r\n\t\t\t\t// Clear the previous directions request\r\n\t\t\t\tif (directionsDisplay !== null && typeof directionsDisplay !== 'undefined') {\r\n\t\t\t\t\tdirectionsDisplay.setMap(null);\r\n\t\t\t\t\tdirectionsDisplay = null;\r\n\t\t\t\t}\r\n\r\n\t\t\t\tdirectionsDisplay = new google.maps.DirectionsRenderer();\r\n\t\t\t\tdirectionsService = new google.maps.DirectionsService();\r\n\r\n\t\t\t\t// Directions request\r\n\t\t\t\tdirectionsDisplay.setMap(map);\r\n\t\t\t\tdirectionsDisplay.setPanel($('.bh-sl-directions-panel').get(0));\r\n\r\n\t\t\t\tvar request = {\r\n\t\t\t\t\torigin: origin,\r\n\t\t\t\t\tdestination: destination,\r\n\t\t\t\t\ttravelMode: google.maps.TravelMode.DRIVING\r\n\t\t\t\t};\r\n\t\t\t\tdirectionsService.route(request, function (response, status) {\r\n\t\t\t\t\tif (status === google.maps.DirectionsStatus.OK) {\r\n\t\t\t\t\t\tdirectionsDisplay.setDirections(response);\r\n\t\t\t\t\t}\r\n\t\t\t\t});\r\n\r\n\t\t\t\t$('.' + this.settings.locationList).prepend(\r\n\t\t\t\t\t'<div class=\"bh-sl-close-directions-container\"><div class=\"' + this.settings.closeIcon + '\"></div></div>'\r\n\t\t\t\t);\r\n\t\t\t}\r\n\r\n\t\t\t$(document).off('click', '.' + this.settings.locationList + ' li .loc-directions a');\r\n\t\t},\r\n\r\n\t\t/**\r\n\t\t * Close the directions panel and reset the map with the original locationset and zoom\r\n\t\t */\r\n\t\tcloseDirections: function () {\r\n\t\t\tthis.writeDebug('closeDirections');\r\n\r\n\t\t\t// Close directions callback\r\n\t\t\tif (this.settings.callbackCloseDirections) {\r\n\t\t\t\tthis.settings.callbackCloseDirections.call(this);\r\n\t\t\t}\r\n\r\n\t\t\t// Remove the close icon, remove the directions, add the list back\r\n\t\t\tthis.reset();\r\n\r\n\t\t\tif (olat && olng) {\r\n\t\t\t\tif (this.countFilters() === 0) {\r\n\t\t\t\t\tthis.settings.mapSettings.zoom = originalZoom;\r\n\t\t\t\t} else {\r\n\t\t\t\t\tthis.settings.mapSettings.zoom = 0;\r\n\t\t\t\t}\r\n\t\t\t\tthis.processForm(null);\r\n\t\t\t}\r\n\r\n\t\t\t$(document).off('click.' + pluginName, '.' + this.settings.locationList + ' .bh-sl-close-icon');\r\n\t\t},\r\n\r\n\t\t/**\r\n\t\t * Handle length unit swap\r\n\t\t *\r\n\t\t * @param $lengthSwap\r\n\t\t */\r\n\t\tlengthUnitSwap: function ($lengthSwap) {\r\n\t\t\tthis.writeDebug('lengthUnitSwap', arguments);\r\n\r\n\t\t\tif ($lengthSwap.val() === 'alt-distance') {\r\n\t\t\t\t$('.' + this.settings.locationList + ' .loc-alt-dist').show();\r\n\t\t\t\t$('.' + this.settings.locationList + ' .loc-default-dist').hide();\r\n\t\t\t} else if ($lengthSwap.val() === 'default-distance') {\r\n\t\t\t\t$('.' + this.settings.locationList + ' .loc-default-dist').show();\r\n\t\t\t\t$('.' + this.settings.locationList + ' .loc-alt-dist').hide();\r\n\t\t\t}\r\n\t\t},\r\n\r\n\t\t/**\r\n\t\t * Process the form values and/or query string\r\n\t\t *\r\n\t\t * @param e {Object} event\r\n\t\t */\r\n\t\tprocessForm: function (e) {\r\n\t\t\tthis.writeDebug('processForm', arguments);\r\n\t\t\tvar _this = this,\r\n\t\t\t\tdistance = null,\r\n\t\t\t\tgeocodeRestrictions = {},\r\n\t\t\t\t$addressInput = $('#' + this.settings.addressID),\r\n\t\t\t\t$searchInput = $('#' + this.settings.searchID),\r\n\t\t\t\t$distanceInput = $('#' + this.settings.maxDistanceID),\r\n\t\t\t\tregion = '';\r\n\r\n\t\t\t// Stop the form submission.\r\n\t\t\tif (typeof e !== 'undefined' && e !== null) {\r\n\t\t\t\te.preventDefault();\r\n\t\t\t}\r\n\r\n\t\t\t// Blur any form field to hide mobile keyboards.\r\n\t\t\t$('.' + _this.settings.formContainer + ' input, .' + _this.settings.formContainer + ' select').blur();\r\n\r\n\t\t\t// Query string parameters\r\n\t\t\tif (this.settings.querystringParams === true) {\r\n\t\t\t\t// Check for query string parameters\r\n\t\t\t\tif (\r\n\t\t\t\t\tthis.getQueryString(this.settings.addressID) ||\r\n\t\t\t\t\tthis.getQueryString(this.settings.searchID) ||\r\n\t\t\t\t\tthis.getQueryString(this.settings.maxDistanceID)\r\n\t\t\t\t) {\r\n\t\t\t\t\taddressInput = this.getQueryString(this.settings.addressID);\r\n\t\t\t\t\tsearchInput = this.getQueryString(this.settings.searchID);\r\n\t\t\t\t\tdistance = this.getQueryString(this.settings.maxDistanceID);\r\n\r\n\t\t\t\t\t// The form should override the query string parameters.\r\n\t\t\t\t\tif ($addressInput.val() !== '') {\r\n\t\t\t\t\t\taddressInput = $addressInput.val();\r\n\t\t\t\t\t}\r\n\t\t\t\t\tif ($searchInput.val() !== '') {\r\n\t\t\t\t\t\tsearchInput = $searchInput.val();\r\n\t\t\t\t\t}\r\n\t\t\t\t\tif ($distanceInput.val() !== '') {\r\n\t\t\t\t\t\tdistance = $distanceInput.val();\r\n\t\t\t\t\t}\r\n\t\t\t\t} else {\r\n\t\t\t\t\t// Get the user input and use it\r\n\t\t\t\t\taddressInput = $addressInput.val() || '';\r\n\t\t\t\t\tsearchInput = $searchInput.val() || '';\r\n\r\n\t\t\t\t\t// Get the distance if set\r\n\t\t\t\t\tif (this.settings.maxDistance === true) {\r\n\t\t\t\t\t\tdistance = $distanceInput.val() || '';\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\t\t\t} else {\r\n\t\t\t\t// Get the user input and use it\r\n\t\t\t\taddressInput = $addressInput.val() || '';\r\n\t\t\t\tsearchInput = $searchInput.val() || '';\r\n\t\t\t\t// Get the distance if set\r\n\t\t\t\tif (this.settings.maxDistance === true) {\r\n\t\t\t\t\tdistance = $distanceInput.val() || '';\r\n\t\t\t\t}\r\n\t\t\t}\r\n\r\n\t\t\t// Region\r\n\t\t\tif (this.settings.callbackRegion) {\r\n\t\t\t\t// Region override callback\r\n\t\t\t\tregion = this.settings.callbackRegion.call(this, addressInput, searchInput, distance);\r\n\t\t\t} else {\r\n\t\t\t\t// Region setting\r\n\t\t\t\tregion = $('#' + this.settings.regionID).val();\r\n\t\t\t}\r\n\r\n\t\t\t// Form values callback\r\n\t\t\tif (this.settings.callbackFormVals) {\r\n\t\t\t\tthis.settings.callbackFormVals.call(this, addressInput, searchInput, distance, region);\r\n\t\t\t}\r\n\r\n\t\t\t// Add component restriction if the region has been set.\r\n\t\t\tif (typeof region !== 'undefined') {\r\n\t\t\t\tgeocodeRestrictions = {\r\n\t\t\t\t\tcountry: region\r\n\t\t\t\t};\r\n\t\t\t}\r\n\r\n\t\t\t// Component restriction value via callback.\r\n\t\t\tif (typeof this.settings.callbackGeocodeRestrictions === 'function') {\r\n\t\t\t\t// Component restriction override callback\r\n\t\t\t\tgeocodeRestrictions = this.settings.callbackGeocodeRestrictions.call(this, addressInput, searchInput, distance);\r\n\t\t\t}\r\n\r\n\t\t\tif (addressInput === '' && searchInput === '' && this.settings.autoGeocode !== true) {\r\n\t\t\t\tthis._start();\r\n\t\t\t} else if (addressInput !== '') {\r\n\t\t\t\t// Check for existing name search and remove if address input is blank.\r\n\t\t\t\tif (searchInput === '' && filters.hasOwnProperty('name')) {\r\n\t\t\t\t\tdelete filters.name;\r\n\t\t\t\t}\r\n\r\n\t\t\t\t// Geocode the origin if needed\r\n\t\t\t\tif (typeof originalOrigin !== 'undefined' && typeof olat !== 'undefined' && typeof olng !== 'undefined' && addressInput === originalOrigin) {\r\n\t\t\t\t\t// Run the mapping function\r\n\t\t\t\t\tmappingObj.lat = olat;\r\n\t\t\t\t\tmappingObj.lng = olng;\r\n\t\t\t\t\tmappingObj.origin = addressInput;\r\n\t\t\t\t\tmappingObj.name = searchInput;\r\n\t\t\t\t\tmappingObj.distance = distance;\r\n\t\t\t\t\t_this.mapping(mappingObj);\r\n\t\t\t\t} else {\r\n\t\t\t\t\tvar g = new this.googleGeocode(this);\r\n\t\t\t\t\tg.geocode(\r\n\t\t\t\t\t\t{\r\n\t\t\t\t\t\t\taddress: addressInput,\r\n\t\t\t\t\t\t\tcomponentRestrictions: geocodeRestrictions,\r\n\t\t\t\t\t\t\tregion: region\r\n\t\t\t\t\t\t},\r\n\t\t\t\t\t\tfunction (data) {\r\n\t\t\t\t\t\t\tif (data !== null) {\r\n\t\t\t\t\t\t\t\tolat = data.latitude;\r\n\t\t\t\t\t\t\t\tolng = data.longitude;\r\n\r\n\t\t\t\t\t\t\t\t// Run the mapping function\r\n\t\t\t\t\t\t\t\tmappingObj.lat = olat;\r\n\t\t\t\t\t\t\t\tmappingObj.lng = olng;\r\n\t\t\t\t\t\t\t\tmappingObj.origin = addressInput;\r\n\t\t\t\t\t\t\t\tmappingObj.name = searchInput;\r\n\t\t\t\t\t\t\t\tmappingObj.distance = distance;\r\n\t\t\t\t\t\t\t\tmappingObj.geocodeResult = data.geocodeResult;\r\n\t\t\t\t\t\t\t\t_this.mapping(mappingObj);\r\n\t\t\t\t\t\t\t} else {\r\n\t\t\t\t\t\t\t\t// Unable to geocode\r\n\t\t\t\t\t\t\t\t_this.notify(_this.settings.addressErrorAlert);\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t);\r\n\t\t\t\t}\r\n\t\t\t} else if (searchInput !== '') {\r\n\t\t\t\t// Check for existing origin and remove if address input is blank.\r\n\t\t\t\tif (addressInput === '') {\r\n\t\t\t\t\tdelete mappingObj.origin;\r\n\t\t\t\t}\r\n\r\n\t\t\t\tmappingObj.name = searchInput;\r\n\t\t\t\t_this.mapping(mappingObj);\r\n\t\t\t} else if (this.settings.autoGeocode === true) {\r\n\t\t\t\t// Run the mapping function\r\n\t\t\t\tmappingObj.lat = olat;\r\n\t\t\t\tmappingObj.lng = olng;\r\n\t\t\t\tmappingObj.origin = addressInput;\r\n\t\t\t\tmappingObj.name = searchInput;\r\n\t\t\t\tmappingObj.distance = distance;\r\n\t\t\t\t_this.mapping(mappingObj);\r\n\t\t\t}\r\n\t\t},\r\n\r\n\t\t/**\r\n\t\t * Checks distance of each location and sets up the locationset array\r\n\t\t *\r\n\t\t * @param data {Object} location data object\r\n\t\t * @param lat {number} origin latitude\r\n\t\t * @param lng {number} origin longitude\r\n\t\t * @param origin {string} origin address\r\n\t\t * @param maxDistance {number} maximum distance if set\r\n\t\t */\r\n\t\tlocationsSetup: function (data, lat, lng, origin, maxDistance) {\r\n\t\t\tthis.writeDebug('locationsSetup', arguments);\r\n\t\t\tif (typeof origin !== 'undefined') {\r\n\t\t\t\tif (!data.distance) {\r\n\t\t\t\t\tdata.distance = this.geoCodeCalcCalcDistance(lat, lng, data.lat, data.lng, GeoCodeCalc.EarthRadius);\r\n\r\n\t\t\t\t\t// Alternative distance length unit\r\n\t\t\t\t\tif (this.settings.lengthUnit === 'm') {\r\n\t\t\t\t\t\t// Miles to kilometers\r\n\t\t\t\t\t\tdata.altdistance = parseFloat(data.distance) * 1.609344;\r\n\t\t\t\t\t} else if (this.settings.lengthUnit === 'km') {\r\n\t\t\t\t\t\t// Kilometers to miles\r\n\t\t\t\t\t\tdata.altdistance = parseFloat(data.distance) / 1.609344;\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\t\t\t}\r\n\r\n\t\t\t// Make sure the location coordinates are valid.\r\n\t\t\tif (!this.coordinatesInRange(data.lat, data.lng)) {\r\n\t\t\t\tthis.writeDebug('locationsSetup', 'location ignored because coordinates out of range: ' + maxDistance, data);\r\n\t\t\t\treturn;\r\n\t\t\t}\r\n\r\n\t\t\t// Create the array\r\n\t\t\tif (this.settings.maxDistance === true && typeof maxDistance !== 'undefined' && maxDistance !== null) {\r\n\t\t\t\tif (data.distance <= maxDistance) {\r\n\t\t\t\t\tlocationset.push(data);\r\n\t\t\t\t} else {\r\n\t\t\t\t\tthis.writeDebug('locationsSetup', 'location ignored because it is out of maxDistance: ' + maxDistance, data);\r\n\t\t\t\t\treturn;\r\n\t\t\t\t}\r\n\t\t\t} else if (\r\n\t\t\t\tthis.settings.maxDistance === true &&\r\n\t\t\t\tthis.settings.querystringParams === true &&\r\n\t\t\t\ttypeof maxDistance !== 'undefined' &&\r\n\t\t\t\tmaxDistance !== null\r\n\t\t\t) {\r\n\t\t\t\tif (data.distance <= maxDistance) {\r\n\t\t\t\t\tlocationset.push(data);\r\n\t\t\t\t} else {\r\n\t\t\t\t\tthis.writeDebug('locationsSetup', 'location ignored because it is out of maxDistance: ' + maxDistance, data);\r\n\t\t\t\t\treturn;\r\n\t\t\t\t}\r\n\t\t\t} else {\r\n\t\t\t\tlocationset.push(data);\r\n\t\t\t}\r\n\t\t},\r\n\r\n\t\t/**\r\n\t\t * Set up front-end sorting functionality\r\n\t\t */\r\n\t\tsorting: function () {\r\n\t\t\tthis.writeDebug('sorting', arguments);\r\n\t\t\tvar _this = this,\r\n\t\t\t\t$mapDiv = $('#' + _this.settings.mapID),\r\n\t\t\t\t$sortSelect = $('#' + _this.settings.sortID);\r\n\r\n\t\t\tif ($sortSelect.length === 0) {\r\n\t\t\t\treturn;\r\n\t\t\t}\r\n\r\n\t\t\t$sortSelect.on('change.' + pluginName, function (e) {\r\n\t\t\t\te.stopPropagation();\r\n\r\n\t\t\t\t// Reset pagination.\r\n\t\t\t\tif (_this.settings.pagination === true) {\r\n\t\t\t\t\t_this.paginationChange(0);\r\n\t\t\t\t}\r\n\r\n\t\t\t\tvar sortMethod, sortVal;\r\n\r\n\t\t\t\tsortMethod =\r\n\t\t\t\t\ttypeof $(this).find(':selected').attr('data-method') !== 'undefined' ? $(this).find(':selected').attr('data-method') : 'distance';\r\n\t\t\t\tsortVal = $(this).val();\r\n\r\n\t\t\t\t_this.settings.sortBy.method = sortMethod;\r\n\t\t\t\t_this.settings.sortBy.prop = sortVal;\r\n\r\n\t\t\t\t// Callback\r\n\t\t\t\tif (_this.settings.callbackSorting) {\r\n\t\t\t\t\t_this.settings.callbackSorting.call(this, _this.settings.sortBy);\r\n\t\t\t\t}\r\n\r\n\t\t\t\tif ($mapDiv.hasClass('bh-sl-map-open')) {\r\n\t\t\t\t\t_this.mapping(mappingObj);\r\n\t\t\t\t}\r\n\t\t\t});\r\n\t\t},\r\n\r\n\t\t/**\r\n\t\t * Set up front-end ordering functionality - this ties in to sorting and that has to be enabled for this to\r\n\t\t * work.\r\n\t\t */\r\n\t\torder: function () {\r\n\t\t\tthis.writeDebug('order', arguments);\r\n\t\t\tvar _this = this,\r\n\t\t\t\t$mapDiv = $('#' + _this.settings.mapID),\r\n\t\t\t\t$orderSelect = $('#' + _this.settings.orderID);\r\n\r\n\t\t\tif ($orderSelect.length === 0) {\r\n\t\t\t\treturn;\r\n\t\t\t}\r\n\r\n\t\t\t$orderSelect.on('change.' + pluginName, function (e) {\r\n\t\t\t\te.stopPropagation();\r\n\r\n\t\t\t\t// Reset pagination.\r\n\t\t\t\tif (_this.settings.pagination === true) {\r\n\t\t\t\t\t_this.paginationChange(0);\r\n\t\t\t\t}\r\n\r\n\t\t\t\t_this.settings.sortBy.order = $(this).val();\r\n\r\n\t\t\t\t// Callback\r\n\t\t\t\tif (_this.settings.callbackOrder) {\r\n\t\t\t\t\t_this.settings.callbackOrder.call(this, _this.settings.order);\r\n\t\t\t\t}\r\n\r\n\t\t\t\tif ($mapDiv.hasClass('bh-sl-map-open')) {\r\n\t\t\t\t\t_this.mapping(mappingObj);\r\n\t\t\t\t}\r\n\t\t\t});\r\n\t\t},\r\n\r\n\t\t/**\r\n\t\t * Count the selected filters\r\n\t\t *\r\n\t\t * @returns {number}\r\n\t\t */\r\n\t\tcountFilters: function () {\r\n\t\t\tthis.writeDebug('countFilters');\r\n\t\t\tvar filterCount = 0;\r\n\r\n\t\t\tif (!this.isEmptyObject(filters)) {\r\n\t\t\t\tfor (var key in filters) {\r\n\t\t\t\t\tif (filters.hasOwnProperty(key)) {\r\n\t\t\t\t\t\tfilterCount += filters[key].length;\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\t\t\t}\r\n\r\n\t\t\treturn filterCount;\r\n\t\t},\r\n\r\n\t\t/**\r\n\t\t * Find the existing checked boxes for each checkbox filter - private\r\n\t\t *\r\n\t\t * @param key {string} object key\r\n\t\t */\r\n\t\t_existingCheckedFilters: function (key) {\r\n\t\t\tthis.writeDebug('_existingCheckedFilters', arguments);\r\n\t\t\t$('#' + this.settings.taxonomyFilters[key] + ' input[type=checkbox]').each(function () {\r\n\t\t\t\tif ($(this).prop('checked')) {\r\n\t\t\t\t\tvar filterVal = $(this).val();\r\n\r\n\t\t\t\t\t// Only add the taxonomy id if it doesn't already exist\r\n\t\t\t\t\tif (typeof filterVal !== 'undefined' && filterVal !== '' && filters[key].indexOf(filterVal) === -1) {\r\n\t\t\t\t\t\tfilters[key].push(filterVal);\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\t\t\t});\r\n\t\t},\r\n\r\n\t\t/**\r\n\t\t * Find the existing selected value for each select filter - private\r\n\t\t *\r\n\t\t * @param key {string} object key\r\n\t\t */\r\n\t\t_existingSelectedFilters: function (key) {\r\n\t\t\tthis.writeDebug('_existingSelectedFilters', arguments);\r\n\t\t\t$('#' + this.settings.taxonomyFilters[key] + ' select').each(function () {\r\n\t\t\t\tvar filterVal = $(this).val();\r\n\r\n\t\t\t\t// Only add the taxonomy id if it doesn't already exist\r\n\t\t\t\tif (typeof filterVal !== 'undefined' && filterVal !== '' && filters[key].indexOf(filterVal) === -1) {\r\n\t\t\t\t\tfilters[key] = [filterVal];\r\n\t\t\t\t}\r\n\t\t\t});\r\n\t\t},\r\n\r\n\t\t/**\r\n\t\t * Find the existing selected value for each radio button filter - private\r\n\t\t *\r\n\t\t * @param key {string} object key\r\n\t\t */\r\n\t\t_existingRadioFilters: function (key) {\r\n\t\t\tthis.writeDebug('_existingRadioFilters', arguments);\r\n\t\t\t$('#' + this.settings.taxonomyFilters[key] + ' input[type=radio]').each(function () {\r\n\t\t\t\tif ($(this).prop('checked')) {\r\n\t\t\t\t\tvar filterVal = $(this).val();\r\n\r\n\t\t\t\t\t// Only add the taxonomy id if it doesn't already exist\r\n\t\t\t\t\tif (typeof filterVal !== 'undefined' && filterVal !== '' && filters[key].indexOf(filterVal) === -1) {\r\n\t\t\t\t\t\tfilters[key] = [filterVal];\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\t\t\t});\r\n\t\t},\r\n\r\n\t\t/**\r\n\t\t * Check for existing filter selections\r\n\t\t */\r\n\t\tcheckFilters: function () {\r\n\t\t\tthis.writeDebug('checkFilters');\r\n\t\t\tfor (var key in this.settings.taxonomyFilters) {\r\n\t\t\t\tif (this.settings.taxonomyFilters.hasOwnProperty(key)) {\r\n\t\t\t\t\t// Find the existing checked boxes for each checkbox filter\r\n\t\t\t\t\tthis._existingCheckedFilters(key);\r\n\r\n\t\t\t\t\t// Find the existing selected value for each select filter\r\n\t\t\t\t\tthis._existingSelectedFilters(key);\r\n\r\n\t\t\t\t\t// Find the existing value for each radio button filter\r\n\t\t\t\t\tthis._existingRadioFilters(key);\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t},\r\n\r\n\t\t/**\r\n\t\t * Select the indicated values from query string parameters.\r\n\t\t *\r\n\t\t * @param taxonomy {string} Current taxonomy.\r\n\t\t * @param value {array} Query string array values.\r\n\t\t */\r\n\t\tselectQueryStringFilters: function (taxonomy, value) {\r\n\t\t\tthis.writeDebug('selectQueryStringFilters', arguments);\r\n\r\n\t\t\tvar $taxGroupContainer = $('#' + this.settings.taxonomyFilters[taxonomy]);\r\n\r\n\t\t\t// Handle checkboxes.\r\n\t\t\tif ($taxGroupContainer.find('input[type=\"checkbox\"]').length) {\r\n\t\t\t\tfor (var i = 0; i < value.length; i++) {\r\n\t\t\t\t\t$taxGroupContainer.find('input:checkbox[value=\"' + value[i] + '\"]').prop('checked', true);\r\n\t\t\t\t}\r\n\t\t\t}\r\n\r\n\t\t\t// Handle select fields.\r\n\t\t\tif ($taxGroupContainer.find('select').length) {\r\n\t\t\t\t// Only expecting one value for select fields.\r\n\t\t\t\t$taxGroupContainer.find('option[value=\"' + value[0] + '\"]').prop('selected', true);\r\n\t\t\t}\r\n\r\n\t\t\t// Handle radio buttons.\r\n\t\t\tif ($taxGroupContainer.find('input[type=\"radio\"]').length) {\r\n\t\t\t\t// Only one value for radio button.\r\n\t\t\t\t$taxGroupContainer.find('input:radio[value=\"' + value[0] + '\"]').prop('checked', true);\r\n\t\t\t}\r\n\t\t},\r\n\r\n\t\t/**\r\n\t\t * Check query string parameters for filter values.\r\n\t\t */\r\n\t\tcheckQueryStringFilters: function () {\r\n\t\t\tthis.writeDebug('checkQueryStringFilters', arguments);\r\n\r\n\t\t\t// Loop through the filters.\r\n\t\t\tfor (var key in filters) {\r\n\t\t\t\tif (filters.hasOwnProperty(key)) {\r\n\t\t\t\t\tvar filterVal = this.getQueryString(key);\r\n\r\n\t\t\t\t\t// Check for multiple values separated by comma.\r\n\t\t\t\t\tif (filterVal.indexOf(',') !== -1) {\r\n\t\t\t\t\t\tfilterVal = filterVal.split(',');\r\n\t\t\t\t\t}\r\n\r\n\t\t\t\t\t// Only add the taxonomy id if it doesn't already exist\r\n\t\t\t\t\tif (typeof filterVal !== 'undefined' && filterVal !== '' && filters[key].indexOf(filterVal) === -1) {\r\n\t\t\t\t\t\tif (Array.isArray(filterVal)) {\r\n\t\t\t\t\t\t\tfilters[key] = filterVal;\r\n\t\t\t\t\t\t} else {\r\n\t\t\t\t\t\t\tfilters[key] = [filterVal];\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t}\r\n\r\n\t\t\t\t\t// Select the filters indicated in the query string.\r\n\t\t\t\t\tif (filters[key].length) {\r\n\t\t\t\t\t\tthis.selectQueryStringFilters(key, filters[key]);\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t},\r\n\r\n\t\t/**\r\n\t\t * Get the filter key from the taxonomyFilter setting\r\n\t\t *\r\n\t\t * @param filterContainer {string} ID of the changed filter's container\r\n\t\t */\r\n\t\tgetFilterKey: function (filterContainer) {\r\n\t\t\tthis.writeDebug('getFilterKey', arguments);\r\n\t\t\tfor (var key in this.settings.taxonomyFilters) {\r\n\t\t\t\tif (this.settings.taxonomyFilters.hasOwnProperty(key)) {\r\n\t\t\t\t\tfor (var i = 0; i < this.settings.taxonomyFilters[key].length; i++) {\r\n\t\t\t\t\t\tif (this.settings.taxonomyFilters[key] === filterContainer) {\r\n\t\t\t\t\t\t\treturn key;\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t},\r\n\r\n\t\t/**\r\n\t\t * Initialize or reset the filters object to its original state\r\n\t\t */\r\n\t\ttaxonomyFiltersInit: function () {\r\n\t\t\tthis.writeDebug('taxonomyFiltersInit');\r\n\r\n\t\t\t// Set up the filters\r\n\t\t\tfor (var key in this.settings.taxonomyFilters) {\r\n\t\t\t\tif (this.settings.taxonomyFilters.hasOwnProperty(key)) {\r\n\t\t\t\t\tfilters[key] = [];\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t},\r\n\r\n\t\t/**\r\n\t\t * Taxonomy filtering\r\n\t\t */\r\n\t\ttaxonomyFiltering: function () {\r\n\t\t\tthis.writeDebug('taxonomyFiltering');\r\n\t\t\tvar _this = this;\r\n\r\n\t\t\t// Set up the filters\r\n\t\t\t_this.taxonomyFiltersInit();\r\n\r\n\t\t\t// Check query string for taxonomy parameter keys.\r\n\t\t\t_this.checkQueryStringFilters();\r\n\r\n\t\t\t// Handle filter updates\r\n\t\t\t$('.' + this.settings.taxonomyFiltersContainer).on('change.' + pluginName, 'input, select', function (e) {\r\n\t\t\t\te.stopPropagation();\r\n\r\n\t\t\t\tvar filterVal, filterContainer, filterKey;\r\n\r\n\t\t\t\t// Reset pagination.\r\n\t\t\t\tif (_this.settings.pagination === true) {\r\n\t\t\t\t\t_this.paginationChange(0);\r\n\t\t\t\t}\r\n\r\n\t\t\t\t// Handle checkbox filters\r\n\t\t\t\tif ($(this).is('input[type=\"checkbox\"]')) {\r\n\t\t\t\t\t// First check for existing selections\r\n\t\t\t\t\t_this.checkFilters();\r\n\r\n\t\t\t\t\tfilterVal = $(this).val();\r\n\t\t\t\t\tfilterContainer = $(this).closest('.bh-sl-filters').attr('id');\r\n\t\t\t\t\tfilterKey = _this.getFilterKey(filterContainer);\r\n\r\n\t\t\t\t\tif (filterKey) {\r\n\t\t\t\t\t\t// Add or remove filters based on checkbox values\r\n\t\t\t\t\t\tif ($(this).prop('checked')) {\r\n\t\t\t\t\t\t\t// Add ids to the filter arrays as they are checked\r\n\t\t\t\t\t\t\tif (filters[filterKey].indexOf(filterVal) === -1) {\r\n\t\t\t\t\t\t\t\tfilters[filterKey].push(filterVal);\r\n\t\t\t\t\t\t\t}\r\n\r\n\t\t\t\t\t\t\tif ($('#' + _this.settings.mapID).hasClass('bh-sl-map-open') === true) {\r\n\t\t\t\t\t\t\t\tif (olat && olng) {\r\n\t\t\t\t\t\t\t\t\t_this.settings.mapSettings.zoom = 0;\r\n\t\t\t\t\t\t\t\t\t_this.processForm();\r\n\t\t\t\t\t\t\t\t} else {\r\n\t\t\t\t\t\t\t\t\t_this.mapping(mappingObj);\r\n\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t} else {\r\n\t\t\t\t\t\t\t// Remove ids from the filter arrays as they are unchecked\r\n\t\t\t\t\t\t\tvar filterIndex = filters[filterKey].indexOf(filterVal);\r\n\t\t\t\t\t\t\tif (filterIndex > -1) {\r\n\t\t\t\t\t\t\t\tfilters[filterKey].splice(filterIndex, 1);\r\n\t\t\t\t\t\t\t\tif ($('#' + _this.settings.mapID).hasClass('bh-sl-map-open') === true) {\r\n\t\t\t\t\t\t\t\t\tif (olat && olng) {\r\n\t\t\t\t\t\t\t\t\t\tif (_this.countFilters() === 0) {\r\n\t\t\t\t\t\t\t\t\t\t\t_this.settings.mapSettings.zoom = originalZoom;\r\n\t\t\t\t\t\t\t\t\t\t} else {\r\n\t\t\t\t\t\t\t\t\t\t\t_this.settings.mapSettings.zoom = 0;\r\n\t\t\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t\t\t\t_this.processForm();\r\n\t\t\t\t\t\t\t\t\t} else {\r\n\t\t\t\t\t\t\t\t\t\t_this.mapping(mappingObj);\r\n\t\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\t\t\t\t// Handle select or radio filters\r\n\t\t\t\telse if ($(this).is('select') || $(this).is('input[type=\"radio\"]')) {\r\n\t\t\t\t\t// First check for existing selections\r\n\t\t\t\t\t_this.checkFilters();\r\n\r\n\t\t\t\t\tfilterVal = $(this).val();\r\n\t\t\t\t\tfilterContainer = $(this).closest('.bh-sl-filters').attr('id');\r\n\t\t\t\t\tfilterKey = _this.getFilterKey(filterContainer);\r\n\r\n\t\t\t\t\t// Check for blank filter on select since default val could be empty\r\n\t\t\t\t\tif (filterVal) {\r\n\t\t\t\t\t\tif (filterKey) {\r\n\t\t\t\t\t\t\tfilters[filterKey] = [filterVal];\r\n\t\t\t\t\t\t\tif ($('#' + _this.settings.mapID).hasClass('bh-sl-map-open') === true) {\r\n\t\t\t\t\t\t\t\tif (olat && olng) {\r\n\t\t\t\t\t\t\t\t\t_this.settings.mapSettings.zoom = 0;\r\n\t\t\t\t\t\t\t\t\t_this.processForm();\r\n\t\t\t\t\t\t\t\t} else {\r\n\t\t\t\t\t\t\t\t\t_this.mapping(mappingObj);\r\n\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t}\r\n\t\t\t\t\t// Reset if the default option is selected\r\n\t\t\t\t\telse {\r\n\t\t\t\t\t\tif (filterKey) {\r\n\t\t\t\t\t\t\tfilters[filterKey] = [];\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t\t_this.reset();\r\n\t\t\t\t\t\tif (olat && olng) {\r\n\t\t\t\t\t\t\t_this.settings.mapSettings.zoom = originalZoom;\r\n\t\t\t\t\t\t\t_this.processForm();\r\n\t\t\t\t\t\t} else {\r\n\t\t\t\t\t\t\t_this.mapping(mappingObj);\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\t\t\t});\r\n\t\t},\r\n\r\n\t\t/**\r\n\t\t * Updates the location list to reflect the markers that are displayed on the map\r\n\t\t *\r\n\t\t * @param markers {Object} Map markers\r\n\t\t * @param map {Object} Google map\r\n\t\t */\r\n\t\tcheckVisibleMarkers: function (markers, map) {\r\n\t\t\tthis.writeDebug('checkVisibleMarkers', arguments);\r\n\t\t\tvar _this = this;\r\n\t\t\tvar locations, listHtml;\r\n\r\n\t\t\t// Empty the location list\r\n\t\t\t$('.' + this.settings.locationList + ' ul').empty();\r\n\r\n\t\t\t// Set up the new list\r\n\t\t\t$(markers).each(function (x, marker) {\r\n\t\t\t\tif (map.getBounds().contains(marker.getPosition())) {\r\n\t\t\t\t\t// Define the location data\r\n\t\t\t\t\t_this.listSetup(marker, 0, 0);\r\n\r\n\t\t\t\t\t// Set up the list template with the location data\r\n\t\t\t\t\tlistHtml = listTemplate(locations);\r\n\t\t\t\t\t$('.' + _this.settings.locationList + ' > ul').append(listHtml);\r\n\t\t\t\t}\r\n\t\t\t});\r\n\r\n\t\t\t// Re-add the list background colors\r\n\t\t\t$('.' + this.settings.locationList + ' ul li:even').css('background', this.settings.listColor1);\r\n\t\t\t$('.' + this.settings.locationList + ' ul li:odd').css('background', this.settings.listColor2);\r\n\t\t},\r\n\r\n\t\t/**\r\n\t\t * Performs a new search when the map is dragged to a new position\r\n\t\t *\r\n\t\t * @param map {Object} Google map\r\n\t\t */\r\n\t\tdragSearch: function (map) {\r\n\t\t\tthis.writeDebug('dragSearch', arguments);\r\n\t\t\tvar newCenter = map.getCenter(),\r\n\t\t\t\tnewCenterCoords,\r\n\t\t\t\t_this = this;\r\n\r\n\t\t\t// Save the new zoom setting\r\n\t\t\tthis.settings.mapSettings.zoom = map.getZoom();\r\n\r\n\t\t\tolat = mappingObj.lat = newCenter.lat();\r\n\t\t\tolng = mappingObj.lng = newCenter.lng();\r\n\r\n\t\t\t// Determine the new origin addresss\r\n\t\t\tvar newAddress = new this.reverseGoogleGeocode(this);\r\n\t\t\tnewCenterCoords = new google.maps.LatLng(mappingObj.lat, mappingObj.lng);\r\n\t\t\tnewAddress.geocode({ latLng: newCenterCoords }, function (data) {\r\n\t\t\t\tif (data !== null) {\r\n\t\t\t\t\tmappingObj.origin = addressInput = data.address;\r\n\t\t\t\t\t_this.mapping(mappingObj);\r\n\t\t\t\t} else {\r\n\t\t\t\t\t// Unable to geocode\r\n\t\t\t\t\t_this.notify(_this.settings.addressErrorAlert);\r\n\t\t\t\t}\r\n\t\t\t});\r\n\t\t},\r\n\r\n\t\t/**\r\n\t\t * Handle no results\r\n\t\t */\r\n\t\temptyResult: function () {\r\n\t\t\tthis.writeDebug('emptyResult', arguments);\r\n\t\t\tvar center,\r\n\t\t\t\tlocList = $('.' + this.settings.locationList + ' ul'),\r\n\t\t\t\tmyOptions = this.settings.mapSettings,\r\n\t\t\t\tnoResults;\r\n\r\n\t\t\t// Create the map\r\n\t\t\tthis.map = new google.maps.Map(document.getElementById(this.settings.mapID), myOptions);\r\n\r\n\t\t\t// Callback\r\n\t\t\tif (this.settings.callbackNoResults) {\r\n\t\t\t\tthis.settings.callbackNoResults.call(this, this.map, myOptions);\r\n\t\t\t}\r\n\r\n\t\t\t// Empty the location list\r\n\t\t\tlocList.empty();\r\n\r\n\t\t\t// Append the no results message\r\n\t\t\tnoResults = $(\r\n\t\t\t\t'<li><div class=\"bh-sl-noresults-title\">' +\r\n\t\t\t\t\tthis.settings.noResultsTitle +\r\n\t\t\t\t\t'</div><br><div class=\"bh-sl-noresults-desc\">' +\r\n\t\t\t\t\tthis.settings.noResultsDesc +\r\n\t\t\t\t\t'</li>'\r\n\t\t\t)\r\n\t\t\t\t.hide()\r\n\t\t\t\t.fadeIn();\r\n\t\t\tlocList.append(noResults);\r\n\r\n\t\t\t// Center on the original origin or 0,0 if not available\r\n\t\t\tif (olat && olng) {\r\n\t\t\t\tcenter = new google.maps.LatLng(olat, olng);\r\n\t\t\t} else {\r\n\t\t\t\tcenter = new google.maps.LatLng(0, 0);\r\n\t\t\t}\r\n\r\n\t\t\tthis.map.setCenter(center);\r\n\r\n\t\t\tif (originalZoom) {\r\n\t\t\t\tthis.map.setZoom(originalZoom);\r\n\t\t\t}\r\n\t\t},\r\n\r\n\t\t/**\r\n\t\t * Origin marker setup\r\n\t\t *\r\n\t\t * @param map {Object} Google map\r\n\t\t * @param origin {string} Origin address\r\n\t\t * @param originPoint {Object} LatLng of origin point\r\n\t\t */\r\n\t\toriginMarker: function (map, origin, originPoint) {\r\n\t\t\tthis.writeDebug('originMarker', arguments);\r\n\r\n\t\t\tif (this.settings.originMarker !== true) {\r\n\t\t\t\treturn;\r\n\t\t\t}\r\n\r\n\t\t\tvar marker,\r\n\t\t\t\toriginImg = '';\r\n\r\n\t\t\tif (typeof origin !== 'undefined') {\r\n\t\t\t\tif (this.settings.originMarkerImg !== null) {\r\n\t\t\t\t\tif (this.settings.originMarkerDim === null) {\r\n\t\t\t\t\t\toriginImg = this.markerImage(this.settings.originMarkerImg);\r\n\t\t\t\t\t} else {\r\n\t\t\t\t\t\toriginImg = this.markerImage(this.settings.originMarkerImg, this.settings.originMarkerDim.width, this.settings.originMarkerDim.height);\r\n\t\t\t\t\t}\r\n\t\t\t\t} else {\r\n\t\t\t\t\toriginImg = {\r\n\t\t\t\t\t\turl: 'https://mt.googleapis.com/vt/icon/name=icons/spotlight/spotlight-waypoint-a.png'\r\n\t\t\t\t\t};\r\n\t\t\t\t}\r\n\r\n\t\t\t\tmarker = new google.maps.Marker({\r\n\t\t\t\t\tposition: originPoint,\r\n\t\t\t\t\tmap: map,\r\n\t\t\t\t\ticon: originImg,\r\n\t\t\t\t\tdraggable: false\r\n\t\t\t\t});\r\n\t\t\t}\r\n\t\t},\r\n\r\n\t\t/**\r\n\t\t * Modal window setup\r\n\t\t */\r\n\t\tmodalWindow: function () {\r\n\t\t\tthis.writeDebug('modalWindow');\r\n\r\n\t\t\tif (this.settings.modal !== true) {\r\n\t\t\t\treturn;\r\n\t\t\t}\r\n\r\n\t\t\tvar _this = this;\r\n\r\n\t\t\t// Callback\r\n\t\t\tif (_this.settings.callbackModalOpen) {\r\n\t\t\t\t_this.settings.callbackModalOpen.call(this);\r\n\t\t\t}\r\n\r\n\t\t\t// Pop up the modal window\r\n\t\t\t$('.' + _this.settings.overlay).fadeIn();\r\n\t\t\t// Close modal when close icon is clicked and when background overlay is clicked\r\n\t\t\t$(document).on('click.' + pluginName, '.' + _this.settings.closeIcon + ', .' + _this.settings.overlay, function () {\r\n\t\t\t\t_this.modalClose();\r\n\t\t\t});\r\n\t\t\t// Prevent clicks within the modal window from closing the entire thing\r\n\t\t\t$(document).on('click.' + pluginName, '.' + _this.settings.modalWindow, function (e) {\r\n\t\t\t\te.stopPropagation();\r\n\t\t\t});\r\n\t\t\t// Close modal when escape key is pressed\r\n\t\t\t$(document).on('keyup.' + pluginName, function (e) {\r\n\t\t\t\tif (e.keyCode === 27) {\r\n\t\t\t\t\t_this.modalClose();\r\n\t\t\t\t}\r\n\t\t\t});\r\n\t\t},\r\n\r\n\t\t/**\r\n\t\t * Open and select the location closest to the origin\r\n\t\t *\r\n\t\t * @param nearestLoc {Object} Details for the nearest location\r\n\t\t * @param infowindow {Object} Info window object\r\n\t\t * @param storeStart {number} Starting point of current page when pagination is enabled\r\n\t\t * @param page {number} Current page number when pagination is enabled\r\n\t\t */\r\n\t\topenNearestLocation: function (nearestLoc, infowindow, storeStart, page) {\r\n\t\t\tthis.writeDebug('openNearestLocation', arguments);\r\n\r\n\t\t\tif (\r\n\t\t\t\tthis.settings.openNearest !== true ||\r\n\t\t\t\ttypeof nearestLoc === 'undefined' ||\r\n\t\t\t\ttypeof originalOrigin === 'undefined' ||\r\n\t\t\t\t(this.settings.fullMapStart === true && firstRun === true && this.settings.querystringParams === false) ||\r\n\t\t\t\t(this.settings.defaultLoc === true && firstRun === true && this.settings.querystringParams === false)\r\n\t\t\t) {\r\n\t\t\t\treturn;\r\n\t\t\t}\r\n\r\n\t\t\tvar _this = this;\r\n\r\n\t\t\t// Callback\r\n\t\t\tif (_this.settings.callbackNearestLoc) {\r\n\t\t\t\t_this.settings.callbackNearestLoc.call(this, _this.map, nearestLoc, infowindow, storeStart, page);\r\n\t\t\t}\r\n\r\n\t\t\tvar markerId = nearestLoc.hasOwnProperty('markerid') ? nearestLoc.markerid : 0;\r\n\t\t\tvar selectedMarker = markers[markerId];\r\n\r\n\t\t\t_this.createInfowindow(selectedMarker, 'left', infowindow, storeStart, page);\r\n\r\n\t\t\t// Scroll list to selected marker\r\n\t\t\tvar $container = $('.' + _this.settings.locationList);\r\n\t\t\tvar $selectedLocation = $('.' + _this.settings.locationList + ' li[data-markerid=' + markerId + ']');\r\n\r\n\t\t\t// Focus on the list\r\n\t\t\t$('.' + _this.settings.locationList + ' li').removeClass('list-focus');\r\n\t\t\t$selectedLocation.addClass('list-focus');\r\n\r\n\t\t\t$container.animate({\r\n\t\t\t\tscrollTop: $selectedLocation.offset().top - $container.offset().top + $container.scrollTop()\r\n\t\t\t});\r\n\t\t},\r\n\r\n\t\t/**\r\n\t\t * Handle clicks from the location list\r\n\t\t *\r\n\t\t * @param map {Object} Google map\r\n\t\t * @param infowindow {Object} Info window object\r\n\t\t * @param storeStart {number} Starting point of current page when pagination is enabled\r\n\t\t * @param page {number} Current page number when pagination is enabled\r\n\t\t */\r\n\t\tlistClick: function (map, infowindow, storeStart, page) {\r\n\t\t\tthis.writeDebug('listClick', arguments);\r\n\t\t\tvar _this = this;\r\n\r\n\t\t\t$(document).on('click.' + pluginName, '.' + _this.settings.locationList + ' li', function () {\r\n\t\t\t\tvar markerId = $(this).data('markerid');\r\n\t\t\t\tvar selectedMarker = markers[markerId];\r\n\r\n\t\t\t\t// List click callback\r\n\t\t\t\tif (_this.settings.callbackListClick) {\r\n\t\t\t\t\t_this.settings.callbackListClick.call(this, markerId, selectedMarker, locationset[markerId], map);\r\n\t\t\t\t}\r\n\r\n\t\t\t\tmap.panTo(selectedMarker.getPosition());\r\n\t\t\t\tvar listLoc = 'left';\r\n\t\t\t\t_this.createInfowindow(selectedMarker, listLoc, infowindow, storeStart, page);\r\n\r\n\t\t\t\t// Custom selected marker override\r\n\t\t\t\tif (_this.settings.selectedMarkerImg !== null) {\r\n\t\t\t\t\t_this.changeSelectedMarker(selectedMarker);\r\n\t\t\t\t}\r\n\r\n\t\t\t\t// Focus on the list\r\n\t\t\t\t$('.' + _this.settings.locationList + ' li').removeClass('list-focus');\r\n\t\t\t\t$('.' + _this.settings.locationList + ' li[data-markerid=' + markerId + ']').addClass('list-focus');\r\n\t\t\t});\r\n\r\n\t\t\t// Prevent bubbling from list content links\r\n\t\t\t$(document).on('click.' + pluginName, '.' + _this.settings.locationList + ' li a', function (e) {\r\n\t\t\t\te.stopPropagation();\r\n\t\t\t});\r\n\t\t},\r\n\r\n\t\t/**\r\n\t\t * Output total results count if HTML element with .bh-sl-total-results class exists\r\n\t\t *\r\n\t\t * @param locCount\r\n\t\t */\r\n\t\tresultsTotalCount: function (locCount) {\r\n\t\t\tthis.writeDebug('resultsTotalCount', arguments);\r\n\r\n\t\t\tvar $resultsContainer = $('.bh-sl-total-results');\r\n\r\n\t\t\tif (typeof locCount === 'undefined' || locCount <= 0 || $resultsContainer.length === 0) {\r\n\t\t\t\treturn;\r\n\t\t\t}\r\n\r\n\t\t\t$resultsContainer.text(locCount);\r\n\t\t},\r\n\r\n\t\t/**\r\n\t\t * Inline directions setup\r\n\t\t *\r\n\t\t * @param map {Object} Google map\r\n\t\t * @param origin {string} Origin address\r\n\t\t */\r\n\t\tinlineDirections: function (map, origin) {\r\n\t\t\tthis.writeDebug('inlineDirections', arguments);\r\n\r\n\t\t\tif (this.settings.inlineDirections !== true || typeof origin === 'undefined') {\r\n\t\t\t\treturn;\r\n\t\t\t}\r\n\r\n\t\t\tvar _this = this;\r\n\r\n\t\t\t// Open directions\r\n\t\t\t$(document).on('click.' + pluginName, '.' + _this.settings.locationList + ' li .loc-directions a', function (e) {\r\n\t\t\t\te.preventDefault();\r\n\t\t\t\tvar locID = $(this).closest('li').attr('data-markerid');\r\n\t\t\t\t_this.directionsRequest(origin, parseInt(locID), map);\r\n\r\n\t\t\t\t// Close directions\r\n\t\t\t\t$(document).on('click.' + pluginName, '.' + _this.settings.locationList + ' .bh-sl-close-icon', function () {\r\n\t\t\t\t\t_this.closeDirections();\r\n\t\t\t\t});\r\n\t\t\t});\r\n\t\t},\r\n\r\n\t\t/**\r\n\t\t * Visible markers list setup\r\n\t\t *\r\n\t\t * @param map {Object} Google map\r\n\t\t * @param markers {Object} Map markers\r\n\t\t */\r\n\t\tvisibleMarkersList: function (map, markers) {\r\n\t\t\tthis.writeDebug('visibleMarkersList', arguments);\r\n\r\n\t\t\tif (this.settings.visibleMarkersList !== true) {\r\n\t\t\t\treturn;\r\n\t\t\t}\r\n\r\n\t\t\tvar _this = this;\r\n\r\n\t\t\t// Add event listener to filter the list when the map is fully loaded\r\n\t\t\tgoogle.maps.event.addListenerOnce(map, 'idle', function () {\r\n\t\t\t\t_this.checkVisibleMarkers(markers, map);\r\n\t\t\t});\r\n\r\n\t\t\t// Add event listener for center change\r\n\t\t\tgoogle.maps.event.addListener(map, 'center_changed', function () {\r\n\t\t\t\t_this.checkVisibleMarkers(markers, map);\r\n\t\t\t});\r\n\r\n\t\t\t// Add event listener for zoom change\r\n\t\t\tgoogle.maps.event.addListener(map, 'zoom_changed', function () {\r\n\t\t\t\t_this.checkVisibleMarkers(markers, map);\r\n\t\t\t});\r\n\t\t},\r\n\r\n\t\t/**\r\n\t\t * Restrict featured locations from displaying in results by a specific distance\r\n\t\t *\r\n\t\t * @returns {Array}\r\n\t\t */\r\n\t\tfeaturedDistanceRestriction: function () {\r\n\t\t\tthis.writeDebug('featuredDistanceRestriction', arguments);\r\n\t\t\tvar _this = this;\r\n\r\n\t\t\tfeaturedset = $.grep(featuredset, function (val) {\r\n\t\t\t\tif (val.hasOwnProperty('distance')) {\r\n\t\t\t\t\treturn parseFloat(val.distance) <= parseFloat(_this.settings.featuredDistance);\r\n\t\t\t\t}\r\n\t\t\t});\r\n\r\n\t\t\treturn featuredset;\r\n\t\t},\r\n\r\n\t\t/**\r\n\t\t * Restrict featured locations by distance.\r\n\t\t *\r\n\t\t * @returns {Array}\r\n\t\t */\r\n\t\tfeaturedRestrictions: function (mappingObject) {\r\n\t\t\tthis.writeDebug('featuredRestrictions', arguments);\r\n\r\n\t\t\tif (this.settings.featuredDistance === null) {\r\n\t\t\t\treturn featuredset;\r\n\t\t\t}\r\n\r\n\t\t\t// Featured locations radius restriction.\r\n\t\t\tif (this.settings.featuredDistance !== null) {\r\n\t\t\t\tfeaturedset = this.featuredDistanceRestriction(mappingObject);\r\n\t\t\t}\r\n\r\n\t\t\treturn featuredset;\r\n\t\t},\r\n\r\n\t\t/**\r\n\t\t * The primary mapping function that runs everything\r\n\t\t *\r\n\t\t * @param mappingObject {Object} all the potential mapping properties - latitude, longitude, origin, name, max\r\n\t\t *     distance, page\r\n\t\t */\r\n\t\tmapping: function (mappingObject) {\r\n\t\t\tthis.writeDebug('mapping', arguments);\r\n\t\t\tvar _this = this;\r\n\t\t\tvar orig_lat, orig_lng, geocodeData, origin, originPoint, page;\r\n\t\t\tif (!this.isEmptyObject(mappingObject)) {\r\n\t\t\t\torig_lat = mappingObject.lat;\r\n\t\t\t\torig_lng = mappingObject.lng;\r\n\t\t\t\tgeocodeData = mappingObject.geocodeResult;\r\n\t\t\t\torigin = mappingObject.origin;\r\n\t\t\t\tpage = mappingObject.page;\r\n\t\t\t}\r\n\r\n\t\t\t// Set the initial page to zero if not set\r\n\t\t\tif (_this.settings.pagination === true) {\r\n\t\t\t\tif (typeof page === 'undefined' || originalOrigin !== addressInput) {\r\n\t\t\t\t\tpage = 0;\r\n\t\t\t\t}\r\n\t\t\t}\r\n\r\n\t\t\t// Data request\r\n\t\t\tif (typeof origin === 'undefined' && this.settings.nameSearch === true) {\r\n\t\t\t\tdataRequest = _this._getData();\r\n\t\t\t} else {\r\n\t\t\t\t// Setup the origin point\r\n\t\t\t\toriginPoint = new google.maps.LatLng(orig_lat, orig_lng);\r\n\r\n\t\t\t\t// If the origin hasn't changed use the existing data so we aren't making unneeded AJAX requests\r\n\t\t\t\tif (typeof originalOrigin !== 'undefined' && origin === originalOrigin && typeof originalData !== 'undefined') {\r\n\t\t\t\t\torigin = originalOrigin;\r\n\t\t\t\t\tdataRequest = originalData;\r\n\t\t\t\t} else {\r\n\t\t\t\t\t// Do the data request - doing this in mapping so the lat/lng and address can be passed over and used if needed\r\n\t\t\t\t\tdataRequest = _this._getData(olat, olng, origin, geocodeData, mappingObject);\r\n\t\t\t\t}\r\n\t\t\t}\r\n\r\n\t\t\t// Check filters here to handle selected filtering after page reload\r\n\t\t\tif (_this.settings.taxonomyFilters !== null && _this.hasEmptyObjectVals(filters)) {\r\n\t\t\t\t_this.checkFilters();\r\n\t\t\t}\r\n\t\t\t/**\r\n\t\t\t * Process the location data\r\n\t\t\t */\r\n\t\t\t// Raw data\r\n\t\t\tif (_this.settings.dataRaw !== null) {\r\n\t\t\t\t_this.processData(mappingObject, originPoint, dataRequest, page);\r\n\t\t\t}\r\n\t\t\t// Remote data\r\n\t\t\telse {\r\n\t\t\t\tdataRequest.done(function (data) {\r\n\t\t\t\t\t_this.processData(mappingObject, originPoint, data, page);\r\n\t\t\t\t});\r\n\t\t\t}\r\n\t\t},\r\n\r\n\t\t/**\r\n\t\t * Reset disabled form fields\r\n\t\t */\r\n\t\tresetDisabledFilterVals: function () {\r\n\t\t\tthis.writeDebug('resetDisabledFilterVals');\r\n\r\n\t\t\tfor (var taxKey in this.settings.taxonomyFilters) {\r\n\t\t\t\tif (this.settings.taxonomyFilters.hasOwnProperty(taxKey)) {\r\n\t\t\t\t\tfor (var x = 0; x < this.settings.taxonomyFilters[taxKey].length; x++) {\r\n\t\t\t\t\t\t$('#' + this.settings.taxonomyFilters[taxKey] + ' input,option').each(function () {\r\n\t\t\t\t\t\t\tvar disabled = $(this).attr('disabled');\r\n\r\n\t\t\t\t\t\t\tif (typeof disabled !== 'undefined') {\r\n\t\t\t\t\t\t\t\t$(this).removeAttr('disabled');\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t});\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t},\r\n\r\n\t\t/**\r\n\t\t * Get available filter values\r\n\t\t *\r\n\t\t * @param callback\r\n\t\t */\r\n\t\tgetAvailableFilters: function (callback) {\r\n\t\t\tthis.writeDebug('getAvailableFilters');\r\n\t\t\tvar availableValues = [];\r\n\r\n\t\t\tfor (var location in locationset) {\r\n\t\t\t\tif (locationset.hasOwnProperty(location)) {\r\n\t\t\t\t\t// Loop through the location values.\r\n\t\t\t\t\tfor (var locationKey in locationset[location]) {\r\n\t\t\t\t\t\tif (filters.hasOwnProperty(locationKey) && locationset[location][locationKey] !== '') {\r\n\t\t\t\t\t\t\tif (availableValues.hasOwnProperty(locationKey)) {\r\n\t\t\t\t\t\t\t\tvar availableVal = availableValues[locationKey].concat(',', locationset[location][locationKey].replace(', ', ',').trim());\r\n\t\t\t\t\t\t\t\tavailableValues[locationKey] = Array.from(new Set(availableVal.split(','))).toString();\r\n\t\t\t\t\t\t\t} else {\r\n\t\t\t\t\t\t\t\tavailableValues[locationKey] = locationset[location][locationKey].replace(', ', ',').trim();\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\t\t\t}\r\n\r\n\t\t\t// Account for missing filter properties in location set.\r\n\t\t\tfor (var keyName in filters) {\r\n\t\t\t\tif (!availableValues.hasOwnProperty(keyName)) {\r\n\t\t\t\t\tavailableValues[keyName] = '';\r\n\t\t\t\t}\r\n\t\t\t}\r\n\r\n\t\t\tcallback(availableValues);\r\n\t\t},\r\n\r\n\t\t/**\r\n\t\t * Disable input fields that aren't available within the current location set\r\n\t\t */\r\n\t\tmaybeDisableFilterOptions: function () {\r\n\t\t\tthis.writeDebug('maybeDisableFilterOptions');\r\n\t\t\tvar availableValues = [];\r\n\t\t\tvar _this = this;\r\n\r\n\t\t\t// Initially reset any input/option fields that were previously disabled.\r\n\t\t\tthis.resetDisabledFilterVals();\r\n\r\n\t\t\t// Loop through current location set to determine what filter values are still available.\r\n\t\t\tthis.getAvailableFilters(function (values) {\r\n\t\t\t\tavailableValues = values;\r\n\r\n\t\t\t\t// Save the original filter values for reference.\r\n\t\t\t\tif (typeof originalFilterVals === 'undefined') {\r\n\t\t\t\t\toriginalFilterVals = availableValues;\r\n\t\t\t\t}\r\n\r\n\t\t\t\t// Update input and option fields to disabled if they're not available.\r\n\t\t\t\tfor (var key in _this.settings.taxonomyFilters) {\r\n\t\t\t\t\tif (_this.settings.taxonomyFilters.hasOwnProperty(key)) {\r\n\t\t\t\t\t\t// Loop through the taxonomy filter group items.\r\n\t\t\t\t\t\tfor (var i = 0; i < _this.settings.taxonomyFilters[key].length; i++) {\r\n\t\t\t\t\t\t\tif (_this.settings.taxonomyFilters.hasOwnProperty(key)) {\r\n\t\t\t\t\t\t\t\t$('#' + _this.settings.taxonomyFilters[key] + ' input, #' + _this.settings.taxonomyFilters[key] + ' option').each(function () {\r\n\t\t\t\t\t\t\t\t\tif ($(this).val() !== '' && Array.from(new Set(availableValues[key].split(','))).indexOf($(this).val()) === -1) {\r\n\t\t\t\t\t\t\t\t\t\t// Handle select options and radio button values when there is no address input.\r\n\t\t\t\t\t\t\t\t\t\tif (\r\n\t\t\t\t\t\t\t\t\t\t\t(typeof addressInput === 'undefined' || addressInput === '') &&\r\n\t\t\t\t\t\t\t\t\t\t\t($(this).prop('tagName') === 'OPTION' || $(this).prop('type') === 'radio') &&\r\n\t\t\t\t\t\t\t\t\t\t\t_this.hasSingleGroupFilterVal(filters, key)\r\n\t\t\t\t\t\t\t\t\t\t) {\r\n\t\t\t\t\t\t\t\t\t\t\treturn;\r\n\t\t\t\t\t\t\t\t\t\t}\r\n\r\n\t\t\t\t\t\t\t\t\t\t// Handle select options and radio button values when there is address input.\r\n\t\t\t\t\t\t\t\t\t\tif (\r\n\t\t\t\t\t\t\t\t\t\t\t(typeof addressInput !== 'undefined' || addressInput !== '') &&\r\n\t\t\t\t\t\t\t\t\t\t\t($(this).prop('tagName') === 'OPTION' || $(this).prop('type') === 'radio') &&\r\n\t\t\t\t\t\t\t\t\t\t\t_this.hasSingleGroupFilterVal(filters, key) &&\r\n\t\t\t\t\t\t\t\t\t\t\tArray.from(new Set(originalFilterVals[key].split(','))).indexOf($(this).val()) !== -1\r\n\t\t\t\t\t\t\t\t\t\t) {\r\n\t\t\t\t\t\t\t\t\t\t\treturn;\r\n\t\t\t\t\t\t\t\t\t\t}\r\n\r\n\t\t\t\t\t\t\t\t\t\t$(this).attr('disabled', true);\r\n\t\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t\t});\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\t\t\t});\r\n\t\t},\r\n\r\n\t\t/**\r\n\t\t * Processes the location data\r\n\t\t *\r\n\t\t * @param mappingObject {Object} all the potential mapping properties - latitude, longitude, origin, name, max\r\n\t\t *     distance, page\r\n\t\t * @param originPoint {Object} LatLng of origin point\r\n\t\t * @param data {Object} location data\r\n\t\t * @param page {number} current page number\r\n\t\t */\r\n\t\tprocessData: function (mappingObject, originPoint, data, page) {\r\n\t\t\tthis.writeDebug('processData', arguments);\r\n\t\t\tvar _this = this;\r\n\t\t\tvar i = 0;\r\n\t\t\tvar orig_lat,\r\n\t\t\t\torig_lng,\r\n\t\t\t\torigin,\r\n\t\t\t\tname,\r\n\t\t\t\tmaxDistance,\r\n\t\t\t\tmarker,\r\n\t\t\t\tbounds,\r\n\t\t\t\tstoreStart,\r\n\t\t\t\tstoreNumToShow,\r\n\t\t\t\tmyOptions,\r\n\t\t\t\tdistError,\r\n\t\t\t\topenMap,\r\n\t\t\t\tinfowindow,\r\n\t\t\t\tnearestLoc;\r\n\t\t\tvar taxFilters = {};\r\n\t\t\tvar $lengthSwap = $('#' + _this.settings.lengthSwapID);\r\n\r\n\t\t\tif (!this.isEmptyObject(mappingObject)) {\r\n\t\t\t\torig_lat = mappingObject.lat;\r\n\t\t\t\torig_lng = mappingObject.lng;\r\n\t\t\t\torigin = mappingObject.origin;\r\n\t\t\t\tname = mappingObject.name;\r\n\t\t\t\tmaxDistance = mappingObject.distance;\r\n\t\t\t}\r\n\r\n\t\t\tvar $mapDiv = $('#' + _this.settings.mapID);\r\n\t\t\t// Get the length unit\r\n\t\t\tvar distUnit = _this.settings.lengthUnit === 'km' ? _this.settings.kilometersLang : _this.settings.milesLang;\r\n\r\n\t\t\t// Save data and origin separately so we can potentially avoid multiple AJAX requests\r\n\t\t\toriginalData = dataRequest;\r\n\t\t\tif (typeof origin !== 'undefined') {\r\n\t\t\t\toriginalOrigin = origin;\r\n\t\t\t}\r\n\r\n\t\t\t// Callback\r\n\t\t\tif (_this.settings.callbackSuccess) {\r\n\t\t\t\t_this.settings.callbackSuccess.call(this, mappingObject, originPoint, data, page);\r\n\t\t\t}\r\n\r\n\t\t\topenMap = $mapDiv.hasClass('bh-sl-map-open');\r\n\r\n\t\t\t// Set a variable for fullMapStart, so we can detect the first run\r\n\t\t\tif (\r\n\t\t\t\t(_this.settings.fullMapStart === true && openMap === false) ||\r\n\t\t\t\t(_this.settings.autoGeocode === true && openMap === false) ||\r\n\t\t\t\t(_this.settings.defaultLoc === true && openMap === false)\r\n\t\t\t) {\r\n\t\t\t\tfirstRun = true;\r\n\t\t\t} else if (\r\n\t\t\t\t(_this.settings.fullMapStart === true && reload === true) ||\r\n\t\t\t\t(_this.settings.autoGeocode === true && reload === true) ||\r\n\t\t\t\t(_this.settings.defaultLoc === true && reload === true)\r\n\t\t\t) {\r\n\t\t\t\t_this.reset();\r\n\t\t\t} else {\r\n\t\t\t\t_this.reset();\r\n\t\t\t}\r\n\r\n\t\t\t$mapDiv.addClass('bh-sl-map-open');\r\n\r\n\t\t\t// Process the location data depending on the data format type\r\n\t\t\tif (_this.settings.dataType === 'json' || _this.settings.dataType === 'jsonp') {\r\n\t\t\t\t// Process JSON\r\n\t\t\t\tfor (var x = 0; i < data.length; x++) {\r\n\t\t\t\t\tvar obj = data[x];\r\n\t\t\t\t\tvar locationData = {};\r\n\r\n\t\t\t\t\t// Parse each data variable\r\n\t\t\t\t\tfor (var key in obj) {\r\n\t\t\t\t\t\tif (obj.hasOwnProperty(key)) {\r\n\t\t\t\t\t\t\tlocationData[key] = obj[key];\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t}\r\n\r\n\t\t\t\t\t_this.locationsSetup(locationData, orig_lat, orig_lng, origin, maxDistance);\r\n\r\n\t\t\t\t\ti++;\r\n\t\t\t\t}\r\n\t\t\t} else if (_this.settings.dataType === 'kml') {\r\n\t\t\t\t// Process KML\r\n\t\t\t\t$(data)\r\n\t\t\t\t\t.find('Placemark')\r\n\t\t\t\t\t.each(function () {\r\n\t\t\t\t\t\tvar locationData = {\r\n\t\t\t\t\t\t\tname: $(this).find('name').text(),\r\n\t\t\t\t\t\t\tlat: $(this).find('coordinates').text().split(',')[1],\r\n\t\t\t\t\t\t\tlng: $(this).find('coordinates').text().split(',')[0],\r\n\t\t\t\t\t\t\tdescription: $(this).find('description').text()\r\n\t\t\t\t\t\t};\r\n\r\n\t\t\t\t\t\t_this.locationsSetup(locationData, orig_lat, orig_lng, origin, maxDistance);\r\n\r\n\t\t\t\t\t\ti++;\r\n\t\t\t\t\t});\r\n\t\t\t} else {\r\n\t\t\t\t// Process XML\r\n\t\t\t\t$(data)\r\n\t\t\t\t\t.find(_this.settings.xmlElement)\r\n\t\t\t\t\t.each(function () {\r\n\t\t\t\t\t\tvar locationData = {};\r\n\r\n\t\t\t\t\t\tfor (var key in this.attributes) {\r\n\t\t\t\t\t\t\tif (this.attributes.hasOwnProperty(key)) {\r\n\t\t\t\t\t\t\t\tlocationData[this.attributes[key].name] = this.attributes[key].value;\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t}\r\n\r\n\t\t\t\t\t\t_this.locationsSetup(locationData, orig_lat, orig_lng, origin, maxDistance);\r\n\r\n\t\t\t\t\t\ti++;\r\n\t\t\t\t\t});\r\n\t\t\t}\r\n\r\n\t\t\t// Name search - using taxonomy filter to handle\r\n\t\t\tif (_this.settings.nameSearch === true) {\r\n\t\t\t\tif (typeof searchInput !== 'undefined' && '' !== searchInput) {\r\n\t\t\t\t\tif (_this.settings.nameAttribute.indexOf(',')) {\r\n\t\t\t\t\t\tnameAttrs = _this.settings.nameAttribute.split(',');\r\n\r\n\t\t\t\t\t\t// Multiple name attributes should swap to exclusive filtering.\r\n\t\t\t\t\t\tif (_this.settings.exclusiveTax !== null) {\r\n\t\t\t\t\t\t\t_this.settings.exclusiveTax.concat(nameAttrs);\r\n\t\t\t\t\t\t} else {\r\n\t\t\t\t\t\t\t_this.settings.exclusiveTax = nameAttrs;\r\n\t\t\t\t\t\t}\r\n\r\n\t\t\t\t\t\tfor (var a = 0; a < nameAttrs.length; a++) {\r\n\t\t\t\t\t\t\tfilters[nameAttrs[a].trim()] = [searchInput];\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t} else {\r\n\t\t\t\t\t\tfilters[_this.settings.nameAttribute] = [searchInput];\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\r\n\t\t\t\t// Check for a previous value.\r\n\t\t\t\tif (typeof searchInput !== 'undefined' && '' === searchInput) {\r\n\t\t\t\t\tif (typeof nameAttrs !== 'undefined') {\r\n\t\t\t\t\t\tfor (var pa = 0; pa < nameAttrs.length; pa++) {\r\n\t\t\t\t\t\t\tif (nameAttrs[pa] in filters) {\r\n\t\t\t\t\t\t\t\tdelete filters[nameAttrs[pa]];\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t} else {\r\n\t\t\t\t\t\tdelete filters[_this.settings.nameAttribute];\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\t\t\t}\r\n\r\n\t\t\t// Taxonomy filtering setup\r\n\t\t\tif (_this.settings.taxonomyFilters !== null || _this.settings.nameSearch === true) {\r\n\t\t\t\tfor (var k in filters) {\r\n\t\t\t\t\tif (filters.hasOwnProperty(k) && filters[k].length > 0) {\r\n\t\t\t\t\t\t// Let's use regex\r\n\t\t\t\t\t\tfor (var z = 0; z < filters[k].length; z++) {\r\n\t\t\t\t\t\t\t// Creating a new object so we don't mess up the original filters\r\n\t\t\t\t\t\t\tif (!taxFilters[k]) {\r\n\t\t\t\t\t\t\t\ttaxFilters[k] = [];\r\n\t\t\t\t\t\t\t}\r\n\r\n\t\t\t\t\t\t\t// Swap pattern matching depending on name search vs. taxonomy filtering.\r\n\t\t\t\t\t\t\tif (typeof nameAttrs !== 'undefined') {\r\n\t\t\t\t\t\t\t\tif (nameAttrs.indexOf(k) !== -1) {\r\n\t\t\t\t\t\t\t\t\ttaxFilters[k][z] = '(?:^|\\\\s)' + filters[k][z].replace(/([.*+?^=!:${}()|\\[\\]\\/\\\\]|&\\s+)/g, '');\r\n\t\t\t\t\t\t\t\t} else {\r\n\t\t\t\t\t\t\t\t\ttaxFilters[k][z] = '(?=.*' + filters[k][z].replace(/([.*+?^=!:${}()|\\[\\]\\/\\\\]|&\\s+)/g, '') + '(?!\\\\s))';\r\n\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t} else {\r\n\t\t\t\t\t\t\t\tif (k === _this.settings.nameAttribute) {\r\n\t\t\t\t\t\t\t\t\ttaxFilters[k][z] = '(?:^|\\\\s)' + filters[k][z].replace(/([.*+?^=!:${}()|\\[\\]\\/\\\\]|&\\s+)/g, '');\r\n\t\t\t\t\t\t\t\t} else {\r\n\t\t\t\t\t\t\t\t\ttaxFilters[k][z] = '(?=.*' + filters[k][z].replace(/([.*+?^=!:${}()|\\[\\]\\/\\\\]|&\\s+)/g, '') + '(?!\\\\s))';\r\n\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\r\n\t\t\t\t// Filter the data\r\n\t\t\t\tif (!_this.isEmptyObject(taxFilters)) {\r\n\t\t\t\t\tlocationset = $.grep(locationset, function (val) {\r\n\t\t\t\t\t\treturn _this.filterData(val, taxFilters);\r\n\t\t\t\t\t});\r\n\t\t\t\t}\r\n\t\t\t}\r\n\r\n\t\t\t// Sorting\r\n\t\t\tif (_this.settings.sortBy !== null && typeof _this.settings.sortBy === 'object') {\r\n\t\t\t\t// Sort the multi-dimensional array by distance to get the nearest location first when enabled\r\n\t\t\t\tif (_this.settings.openNearest === true && typeof originalOrigin !== 'undefined') {\r\n\t\t\t\t\tthis.sortNumerically(locationset, true);\r\n\r\n\t\t\t\t\t// Save the closest location to a variable for openNearest setting\r\n\t\t\t\t\tif (typeof locationset[0] !== 'undefined') {\r\n\t\t\t\t\t\tif (this.settings.sortBy.hasOwnProperty('order') && this.settings.sortBy.order.toString() === 'desc') {\r\n\t\t\t\t\t\t\tnearestLoc = locationset[locationset.length - 1];\r\n\t\t\t\t\t\t} else {\r\n\t\t\t\t\t\t\tnearestLoc = locationset[0];\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\r\n\t\t\t\t// Custom sorting\r\n\t\t\t\t_this.sortCustom(locationset);\r\n\t\t\t} else {\r\n\t\t\t\t// Sort the multi-dimensional array by distance\r\n\t\t\t\tif (typeof origin !== 'undefined') {\r\n\t\t\t\t\t_this.sortNumerically(locationset);\r\n\t\t\t\t}\r\n\r\n\t\t\t\t// Check the closest marker\r\n\t\t\t\tif (_this.isEmptyObject(taxFilters)) {\r\n\t\t\t\t\tif (_this.settings.maxDistance === true && maxDistance) {\r\n\t\t\t\t\t\tif (typeof locationset[0] === 'undefined' || locationset[0].distance > maxDistance) {\r\n\t\t\t\t\t\t\t_this.notify(_this.settings.distanceErrorAlert + maxDistance + ' ' + distUnit);\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t} else {\r\n\t\t\t\t\t\tif (typeof locationset[0] !== 'undefined') {\r\n\t\t\t\t\t\t\tif (_this.settings.distanceAlert !== -1 && locationset[0].distance > _this.settings.distanceAlert) {\r\n\t\t\t\t\t\t\t\t_this.notify(_this.settings.distanceErrorAlert + _this.settings.distanceAlert + ' ' + distUnit);\r\n\t\t\t\t\t\t\t\tdistError = true;\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t} else {\r\n\t\t\t\t\t\t\t_this.emptyResult();\r\n\t\t\t\t\t\t\tthrow new Error('No locations found. Please check the dataLocation setting and path.');\r\n\t\t\t\t\t\t\treturn;\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\r\n\t\t\t\t// Save the closest location to a variable for openNearest setting\r\n\t\t\t\tif (typeof locationset[0] !== 'undefined') {\r\n\t\t\t\t\tnearestLoc = locationset[0];\r\n\t\t\t\t}\r\n\t\t\t}\r\n\r\n\t\t\t// Featured locations filtering\r\n\t\t\tif (_this.settings.featuredLocations === true) {\r\n\t\t\t\t// Create array for featured locations\r\n\t\t\t\tfeaturedset = $.grep(locationset, function (val) {\r\n\t\t\t\t\tif (val.hasOwnProperty('featured')) {\r\n\t\t\t\t\t\treturn val.featured === 'true';\r\n\t\t\t\t\t}\r\n\t\t\t\t});\r\n\r\n\t\t\t\t// Featured location restrictions.\r\n\t\t\t\tfeaturedset = _this.featuredRestrictions(mappingObject);\r\n\r\n\t\t\t\t// Create array for normal locations\r\n\t\t\t\tnormalset = $.grep(locationset, function (val) {\r\n\t\t\t\t\tif (val.hasOwnProperty('featured')) {\r\n\t\t\t\t\t\treturn val.featured !== 'true';\r\n\t\t\t\t\t}\r\n\t\t\t\t});\r\n\r\n\t\t\t\t// Combine the arrays\r\n\t\t\t\tlocationset = [];\r\n\t\t\t\tlocationset = featuredset.concat(normalset);\r\n\t\t\t}\r\n\r\n\t\t\t// Disable filter inputs if there are no locations with the values left.\r\n\t\t\tif (firstRun !== true && this.settings.taxonomyFilters !== null && this.settings.exclusiveFiltering === false) {\r\n\t\t\t\t_this.maybeDisableFilterOptions();\r\n\t\t\t}\r\n\r\n\t\t\t// Slide in the map container\r\n\t\t\tif (_this.settings.slideMap === true) {\r\n\t\t\t\t$this.slideDown();\r\n\t\t\t}\r\n\r\n\t\t\t// Output page numbers if pagination setting is true\r\n\t\t\tif (_this.settings.pagination === true) {\r\n\t\t\t\t_this.paginationSetup(page);\r\n\t\t\t}\r\n\r\n\t\t\t// Alternative method to display no results if locations are too far away instead of all locations.\r\n\t\t\tif (_this.settings.altDistanceNoResult === true && nearestLoc.distance > _this.settings.distanceAlert) {\r\n\t\t\t\t_this.emptyResult();\r\n\t\t\t\treturn;\r\n\t\t\t}\r\n\r\n\t\t\t// Handle no results\r\n\t\t\tif (_this.isEmptyObject(locationset) || locationset[0].result === 'none') {\r\n\t\t\t\t_this.emptyResult();\r\n\t\t\t\treturn;\r\n\t\t\t}\r\n\r\n\t\t\t// Set up the modal window\r\n\t\t\t_this.modalWindow();\r\n\r\n\t\t\t// Avoid error if number of locations is less than the default of 26\r\n\t\t\tif (\r\n\t\t\t\t_this.settings.storeLimit === -1 ||\r\n\t\t\t\tlocationset.length < _this.settings.storeLimit ||\r\n\t\t\t\t(this.settings.fullMapStart === true &&\r\n\t\t\t\t\tfirstRun === true &&\r\n\t\t\t\t\t(!isNaN(this.settings.fullMapStartListLimit) || this.settings.fullMapStartListLimit > 26 || this.settings.fullMapStartListLimit === -1))\r\n\t\t\t) {\r\n\t\t\t\tstoreNum = locationset.length;\r\n\t\t\t} else {\r\n\t\t\t\tstoreNum = _this.settings.storeLimit;\r\n\t\t\t}\r\n\r\n\t\t\t// If fullMapStart is enabled and taxFilters is reset and name search and origin are empty, swap back to the original length.\r\n\t\t\tif (\r\n\t\t\t\t_this.settings.fullMapStart === true &&\r\n\t\t\t\t_this.isEmptyObject(taxFilters) &&\r\n\t\t\t\t(searchInput === '' || typeof searchInput === 'undefined') &&\r\n\t\t\t\t(addressInput === '' || typeof addressInput === 'undefined')\r\n\t\t\t) {\r\n\t\t\t\tstoreNum = locationset.length;\r\n\t\t\t}\r\n\r\n\t\t\t// If pagination is on, change the store limit to the setting and slice the locationset array\r\n\t\t\tif (_this.settings.pagination === true) {\r\n\t\t\t\tstoreNumToShow = _this.settings.locationsPerPage;\r\n\t\t\t\tstoreStart = page * _this.settings.locationsPerPage;\r\n\r\n\t\t\t\tif (storeStart + storeNumToShow > locationset.length) {\r\n\t\t\t\t\tstoreNumToShow = _this.settings.locationsPerPage - (storeStart + storeNumToShow - locationset.length);\r\n\t\t\t\t}\r\n\r\n\t\t\t\tlocationset = locationset.slice(storeStart, storeStart + storeNumToShow);\r\n\t\t\t\tstoreNum = locationset.length;\r\n\t\t\t} else {\r\n\t\t\t\tstoreNumToShow = storeNum;\r\n\t\t\t\tstoreStart = 0;\r\n\t\t\t}\r\n\r\n\t\t\t// Output location results count\r\n\t\t\t_this.resultsTotalCount(locationset.length);\r\n\r\n\t\t\t// Google maps settings\r\n\t\t\tif (\r\n\t\t\t\t(_this.settings.fullMapStart === true && firstRun === true && _this.settings.querystringParams !== true) ||\r\n\t\t\t\t_this.settings.mapSettings.zoom === 0 ||\r\n\t\t\t\ttypeof origin === 'undefined' ||\r\n\t\t\t\tdistError === true ||\r\n\t\t\t\t(_this.settings.maxDistance === true && firstRun === false && this.countFilters() > 0)\r\n\t\t\t) {\r\n\t\t\t\tmyOptions = _this.settings.mapSettings;\r\n\t\t\t\tbounds = new google.maps.LatLngBounds();\r\n\t\t\t} else if (_this.settings.pagination === true) {\r\n\t\t\t\t// Update the map to focus on the first point in the new set\r\n\t\t\t\tvar nextPoint = new google.maps.LatLng(locationset[0].lat, locationset[0].lng);\r\n\r\n\t\t\t\tif (page === 0) {\r\n\t\t\t\t\t_this.settings.mapSettings.center = originPoint;\r\n\t\t\t\t\tmyOptions = _this.settings.mapSettings;\r\n\t\t\t\t} else {\r\n\t\t\t\t\t_this.settings.mapSettings.center = nextPoint;\r\n\t\t\t\t\tmyOptions = _this.settings.mapSettings;\r\n\t\t\t\t}\r\n\t\t\t} else {\r\n\t\t\t\t_this.settings.mapSettings.center = originPoint;\r\n\t\t\t\tmyOptions = _this.settings.mapSettings;\r\n\t\t\t}\r\n\r\n\t\t\t// Create the map\r\n\t\t\t_this.map = new google.maps.Map(document.getElementById(_this.settings.mapID), myOptions);\r\n\r\n\t\t\t// Re-center the map when the browser is re-sized\r\n\t\t\twindow.addEventListener('resize', function () {\r\n\t\t\t\tvar center = _this.map.getCenter();\r\n\t\t\t\tgoogle.maps.event.trigger(_this.map, 'resize');\r\n\t\t\t\t_this.map.setCenter(center);\r\n\t\t\t});\r\n\r\n\t\t\t// Add map drag listener if setting is enabled and re-search on drag end\r\n\t\t\tif (_this.settings.dragSearch === true) {\r\n\t\t\t\t_this.map.addListener('dragend', function () {\r\n\t\t\t\t\t_this.dragSearch(_this.map);\r\n\t\t\t\t});\r\n\t\t\t}\r\n\r\n\t\t\t// Load the map\r\n\t\t\t$this.data(_this.settings.mapID.replace('#', ''), _this.map);\r\n\r\n\t\t\t// Map set callback.\r\n\t\t\tif (_this.settings.callbackMapSet) {\r\n\t\t\t\t_this.settings.callbackMapSet.call(this, _this.map, originPoint, originalZoom, myOptions);\r\n\t\t\t}\r\n\r\n\t\t\t// Initialize the infowindow\r\n\t\t\tif (typeof InfoBubble !== 'undefined' && _this.settings.infoBubble !== null) {\r\n\t\t\t\tvar infoBubbleSettings = _this.settings.infoBubble;\r\n\t\t\t\tinfoBubbleSettings.map = _this.map;\r\n\r\n\t\t\t\tinfowindow = new InfoBubble(infoBubbleSettings);\r\n\t\t\t} else {\r\n\t\t\t\tinfowindow = new google.maps.InfoWindow();\r\n\t\t\t}\r\n\r\n\t\t\t// Add origin marker if the setting is set\r\n\t\t\t_this.originMarker(_this.map, origin, originPoint);\r\n\r\n\t\t\t// Handle pagination\r\n\t\t\t$(document).on('click.' + pluginName, '.bh-sl-pagination li', function (e) {\r\n\t\t\t\te.preventDefault();\r\n\t\t\t\t// Run paginationChange\r\n\t\t\t\t_this.paginationChange($(this).attr('data-page'));\r\n\t\t\t});\r\n\r\n\t\t\t// Inline directions\r\n\t\t\t_this.inlineDirections(_this.map, origin);\r\n\r\n\t\t\t// Add markers and infowindows loop\r\n\t\t\tfor (var y = 0; y <= storeNumToShow - 1; y++) {\r\n\t\t\t\tvar letter = '';\r\n\r\n\t\t\t\tif (page > 0) {\r\n\t\t\t\t\tletter = String.fromCharCode('A'.charCodeAt(0) + (storeStart + y));\r\n\t\t\t\t} else {\r\n\t\t\t\t\tletter = String.fromCharCode('A'.charCodeAt(0) + y);\r\n\t\t\t\t}\r\n\r\n\t\t\t\tvar point = new google.maps.LatLng(locationset[y].lat, locationset[y].lng);\r\n\t\t\t\tmarker = _this.createMarker(point, locationset[y].name, locationset[y].address, letter, _this.map, locationset[y].category);\r\n\t\t\t\tmarker.set('id', y);\r\n\t\t\t\tmarkers[y] = marker;\r\n\r\n\t\t\t\t// Add marker ID to location data\r\n\t\t\t\tlocationset[y].markerid = marker.get('id');\r\n\r\n\t\t\t\tif (this.settings.dataRaw !== null) {\r\n\t\t\t\t\tfor (var l = 0; l < this.settings.dataRaw.length; l++) {\r\n\t\t\t\t\t\tif (this.settings.dataRaw[l] && this.settings.dataRaw[l].hasOwnProperty('id') && this.settings.dataRaw[l].id === locationset[y].id) {\r\n\t\t\t\t\t\t\tthis.settings.dataRaw[l].markerid = locationset[y].markerid;\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\r\n\t\t\t\tif (\r\n\t\t\t\t\t(_this.settings.fullMapStart === true && firstRun === true && _this.settings.querystringParams !== true) ||\r\n\t\t\t\t\t_this.settings.mapSettings.zoom === 0 ||\r\n\t\t\t\t\ttypeof origin === 'undefined' ||\r\n\t\t\t\t\tdistError === true ||\r\n\t\t\t\t\t(_this.settings.maxDistance === true && firstRun === false && this.countFilters() > 0)\r\n\t\t\t\t) {\r\n\t\t\t\t\tbounds.extend(point);\r\n\t\t\t\t}\r\n\t\t\t\t// Pass variables to the pop-up infowindows\r\n\t\t\t\t_this.createInfowindow(marker, null, infowindow, storeStart, page);\r\n\t\t\t}\r\n\r\n\t\t\t// Center and zoom if no origin or zoom was provided, or distance of first marker is greater than distanceAlert\r\n\t\t\tif (\r\n\t\t\t\t(_this.settings.fullMapStart === true && firstRun === true && _this.settings.querystringParams !== true) ||\r\n\t\t\t\t_this.settings.mapSettings.zoom === 0 ||\r\n\t\t\t\ttypeof origin === 'undefined' ||\r\n\t\t\t\tdistError === true ||\r\n\t\t\t\t(_this.settings.maxDistance === true && firstRun === false && this.countFilters() > 0)\r\n\t\t\t) {\r\n\t\t\t\t_this.map.fitBounds(bounds);\r\n\r\n\t\t\t\t// Prevent zooming in too far after fitBounds\r\n\t\t\t\tvar zoomListener = google.maps.event.addListener(_this.map, 'idle', function () {\r\n\t\t\t\t\tif (_this.map.getZoom() > 16) {\r\n\t\t\t\t\t\t_this.map.setZoom(16);\r\n\t\t\t\t\t}\r\n\t\t\t\t\tgoogle.maps.event.removeListener(zoomListener);\r\n\t\t\t\t});\r\n\t\t\t}\r\n\r\n\t\t\t// Create the links that focus on the related marker\r\n\t\t\tvar locList = $('.' + _this.settings.locationList + ' ul');\r\n\t\t\tlocList.empty();\r\n\r\n\t\t\t// Set up the location list markup\r\n\t\t\tif (\r\n\t\t\t\tfirstRun &&\r\n\t\t\t\t_this.settings.fullMapStartListLimit !== false &&\r\n\t\t\t\t!isNaN(_this.settings.fullMapStartListLimit) &&\r\n\t\t\t\t_this.settings.fullMapStartListLimit !== -1 &&\r\n\t\t\t\tmarkers.length > _this.settings.fullMapStartListLimit\r\n\t\t\t) {\r\n\t\t\t\tfor (var m = 0; m < _this.settings.fullMapStartListLimit; m++) {\r\n\t\t\t\t\tvar currentMarker = markers[m];\r\n\t\t\t\t\t_this.listSetup(currentMarker, storeStart, page);\r\n\t\t\t\t}\r\n\t\t\t} else {\r\n\t\t\t\t$(markers).each(function (x) {\r\n\t\t\t\t\tvar currentMarker = markers[x];\r\n\t\t\t\t\t_this.listSetup(currentMarker, storeStart, page);\r\n\t\t\t\t});\r\n\t\t\t}\r\n\r\n\t\t\t// Length unit swap setup\r\n\t\t\tif ($lengthSwap.length) {\r\n\t\t\t\t_this.lengthUnitSwap($lengthSwap);\r\n\r\n\t\t\t\t$lengthSwap.on('change.' + pluginName, function (e) {\r\n\t\t\t\t\te.stopPropagation();\r\n\t\t\t\t\t_this.lengthUnitSwap($lengthSwap);\r\n\t\t\t\t});\r\n\t\t\t}\r\n\r\n\t\t\t// Open nearest location.\r\n\t\t\t_this.openNearestLocation(nearestLoc, infowindow, storeStart, page);\r\n\r\n\t\t\t// MarkerClusterer setup\r\n\t\t\tif (typeof MarkerClusterer !== 'undefined' && _this.settings.markerCluster !== null) {\r\n\t\t\t\tvar markerCluster = new MarkerClusterer(_this.map, markers, _this.settings.markerCluster);\r\n\t\t\t}\r\n\r\n\t\t\t// Handle clicks from the list\r\n\t\t\t_this.listClick(_this.map, infowindow, storeStart, page);\r\n\r\n\t\t\t// Add the list li background colors - this wil be dropped in a future version in favor of CSS\r\n\t\t\t$('.' + _this.settings.locationList + ' ul > li:even').css('background', _this.settings.listColor1);\r\n\t\t\t$('.' + _this.settings.locationList + ' ul > li:odd').css('background', _this.settings.listColor2);\r\n\r\n\t\t\t// Visible markers list\r\n\t\t\t_this.visibleMarkersList(_this.map, markers);\r\n\r\n\t\t\t// Fill in form values from query string parameters.\r\n\t\t\tif (_this.settings.querystringParams === true) {\r\n\t\t\t\tvar $addressInput = $('#' + _this.settings.addressID);\r\n\t\t\t\tvar $searchInput = $('#' + _this.settings.searchID);\r\n\r\n\t\t\t\t// Address field.\r\n\t\t\t\tif (typeof mappingObj !== 'undefined' && mappingObj.hasOwnProperty('origin') && $addressInput.val() === '') {\r\n\t\t\t\t\t$addressInput.val(mappingObj.origin);\r\n\t\t\t\t}\r\n\r\n\t\t\t\t// Name search field.\r\n\t\t\t\tif (typeof mappingObj !== 'undefined' && mappingObj.hasOwnProperty('name') && $searchInput.val() === '') {\r\n\t\t\t\t\t$searchInput.val(mappingObj.name);\r\n\t\t\t\t}\r\n\t\t\t}\r\n\r\n\t\t\t// Modal ready callback\r\n\t\t\tif (_this.settings.modal === true && _this.settings.callbackModalReady) {\r\n\t\t\t\t_this.settings.callbackModalReady.call(this, mappingObject);\r\n\t\t\t}\r\n\r\n\t\t\t// Filters callback\r\n\t\t\tif (_this.settings.callbackFilters) {\r\n\t\t\t\t_this.settings.callbackFilters.call(this, filters, mappingObject);\r\n\t\t\t}\r\n\t\t},\r\n\r\n\t\t/**\r\n\t\t * console.log helper function\r\n\t\t *\r\n\t\t * http://www.briangrinstead.com/blog/console-log-helper-function\r\n\t\t */\r\n\t\twriteDebug: function () {\r\n\t\t\tif (window.console && this.settings.debug) {\r\n\t\t\t\t// Only run on the first time through - reset this function to the appropriate console.log helper\r\n\t\t\t\tif (Function.prototype.bind) {\r\n\t\t\t\t\tthis.writeDebug = Function.prototype.bind.call(console.log, console, 'StoreLocator :');\r\n\t\t\t\t} else {\r\n\t\t\t\t\tthis.writeDebug = function () {\r\n\t\t\t\t\t\targuments[0] = 'StoreLocator : ' + arguments[0];\r\n\t\t\t\t\t\tFunction.prototype.apply.call(console.log, console, arguments);\r\n\t\t\t\t\t};\r\n\t\t\t\t}\r\n\t\t\t\tthis.writeDebug.apply(this, arguments);\r\n\t\t\t}\r\n\t\t}\r\n\t});\r\n\r\n\t// A really lightweight plugin wrapper around the constructor,\r\n\t// preventing against multiple instantiations and allowing any\r\n\t// public function (ie. a function whose name doesn't start\r\n\t// with an underscore) to be called via the jQuery plugin,\r\n\t// e.g. $(element).defaultPluginName('functionName', arg1, arg2)\r\n\t$.fn[pluginName] = function (options) {\r\n\t\tvar args = arguments;\r\n\t\t// Is the first parameter an object (options), or was omitted, instantiate a new instance of the plugin\r\n\t\tif (options === undefined || typeof options === 'object') {\r\n\t\t\treturn this.each(function () {\r\n\t\t\t\t// Only allow the plugin to be instantiated once, so we check that the element has no plugin instantiation yet\r\n\t\t\t\tif (!$.data(this, 'plugin_' + pluginName)) {\r\n\t\t\t\t\t// If it has no instance, create a new one, pass options to our plugin constructor, and store the plugin instance in the elements jQuery data object.\r\n\t\t\t\t\t$.data(this, 'plugin_' + pluginName, new Plugin(this, options));\r\n\t\t\t\t}\r\n\t\t\t});\r\n\t\t\t// Treat this as a call to a public method\r\n\t\t} else if (typeof options === 'string' && options[0] !== '_' && options !== 'init') {\r\n\t\t\t// Cache the method call to make it possible to return a value\r\n\t\t\tvar returns;\r\n\r\n\t\t\tthis.each(function () {\r\n\t\t\t\tvar instance = $.data(this, 'plugin_' + pluginName);\r\n\r\n\t\t\t\t// Tests that there's already a plugin-instance and checks that the requested public method exists\r\n\t\t\t\tif (instance instanceof Plugin && typeof instance[options] === 'function') {\r\n\t\t\t\t\t// Call the method of our plugin instance, and pass it the supplied arguments.\r\n\t\t\t\t\treturns = instance[options].apply(instance, Array.prototype.slice.call(args, 1));\r\n\t\t\t\t}\r\n\r\n\t\t\t\t// Allow instances to be destroyed via the 'destroy' method\r\n\t\t\t\tif (options === 'destroy') {\r\n\t\t\t\t\t$.data(this, 'plugin_' + pluginName, null);\r\n\t\t\t\t}\r\n\t\t\t});\r\n\r\n\t\t\t// If the earlier cached method gives a value back return the value, otherwise return this to preserve chainability.\r\n\t\t\treturn returns !== undefined ? returns : this;\r\n\t\t}\r\n\t};\r\n})(jQuery, window, document);\r\n"],
  "mappings": "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",
  "names": ["$", "window", "document", "undefined", "pluginName", "$this", "map", "listTemplate", "infowindowTemplate", "dataTypeRead", "originalOrigin", "originalData", "originalZoom", "dataRequest", "searchInput", "addressInput", "olat", "olng", "storeNum", "directionsDisplay", "directionsService", "prevSelectedMarkerBefore", "prevSelectedMarkerAfter", "firstRun", "reload", "nameAttrs", "originalFilterVals", "featuredset", "locationset", "normalset", "markers", "filters", "locationData", "GeoCodeCalc", "mappingObj", "defaults", "Plugin", "element", "options", "_this", "url", "autoPlaces", "e", "$mapDiv", "i", "$adp", "$inputs", "$selects", "notifyText", "v", "v1", "v2", "lat1", "lng1", "lat2", "lng2", "radius", "min", "num", "max", "lat", "lng", "param", "regex", "results", "source", "templateError", "template", "address", "geocodeData", "northEast", "southWest", "formattedAddress", "d", "ajaxData", "p", "doAutoGeo", "latlng", "myOptions", "center", "position", "pos", "error", "thisObj", "geocoder", "request", "callbackFunction", "status", "result", "dec", "obj", "key", "objTest", "objCopy", "loopcount", "value", "locationsarray", "property", "a", "b", "distanceOverride", "filter", "val", "inclusive", "applyFilters", "data", "filterTest", "k", "testResults", "l", "currentPage", "totalPages", "output", "nextPage", "prevPage", "n", "pagesOutput", "$paginationList", "markerUrl", "markerWidth", "markerHeight", "markerImg", "point", "name", "letter", "category", "marker", "letterMarkerImg", "categories", "currentMarker", "storeStart", "page", "indicator", "altDistLength", "distLength", "markerId", "locations", "listHtml", "location", "infowindow", "$selectedLocation", "$container", "distance", "$distanceInput", "originAddress", "r", "newPage", "markerID", "locationsLimit", "origin", "locID", "destination", "response", "$lengthSwap", "geocodeRestrictions", "$addressInput", "$searchInput", "region", "g", "maxDistance", "$sortSelect", "sortMethod", "sortVal", "$orderSelect", "filterCount", "filterVal", "taxonomy", "$taxGroupContainer", "filterContainer", "filterKey", "filterIndex", "x", "newCenter", "newCenterCoords", "newAddress", "locList", "noResults", "originPoint", "originImg", "nearestLoc", "selectedMarker", "listLoc", "locCount", "$resultsContainer", "mappingObject", "orig_lat", "orig_lng", "taxKey", "disabled", "callback", "availableValues", "locationKey", "availableVal", "keyName", "values", "bounds", "storeNumToShow", "distError", "openMap", "taxFilters", "distUnit", "pa", "z", "nextPoint", "infoBubbleSettings", "y", "zoomListener", "m", "markerCluster", "args", "returns", "instance"]
}
